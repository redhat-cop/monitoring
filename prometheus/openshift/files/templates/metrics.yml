---
apiVersion: v1
kind: Template
metadata:
  name: metrics-template
objects:
- kind: Namespace 
  apiVersion: v1
  metadata:
    annotations:
      openshift.io/description: 'Cluster and Microservices Metrics'
      openshift.io/display-name: Cluster and Microservices Metrics
      openshift.io/requester: ${USER}
      openshift.io/node-selector: ""
    creationTimestamp: 
    name: ${NAMESPACE}
  spec: {}
  status: {}
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: "${APPLICATION_NAME}-privileged"
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: "${APPLICATION_NAME}-user"
- kind: RoleBinding
  apiVersion: v1
  groupNames:
  - system:serviceaccounts:${NAMESPACE}
  metadata:
    creationTimestamp: 
    name: system:image-pullers
    namespace: ${NAMESPACE}
  roleRef:
    name: system:image-puller
  subjects:
  - kind: SystemGroup
    name: system:serviceaccounts:${NAMESPACE}
  userNames: 
- kind: RoleBinding 
  apiVersion: v1
  groupNames: 
  metadata:
    creationTimestamp: 
    name: system:image-builders
    namespace: ${NAMESPACE}
  roleRef:
    name: system:image-builder
  subjects:
  - kind: ServiceAccount
    name: builder
  userNames:
  - system:serviceaccount:${NAMESPACE}:builder
- kind: RoleBinding
  apiVersion: v1
  groupNames: 
  metadata:
    creationTimestamp: 
    name: system:deployers
    namespace: ${NAMESPACE}
  roleRef:
    name: system:deployer
  subjects:
  - kind: ServiceAccount
    name: deployer
  userNames:
  - system:serviceaccount:${NAMESPACE}:deployer
- kind: RoleBinding
  apiVersion: v1
  groupNames: 
  metadata:
    creationTimestamp: 
    name: admin
    namespace: ${NAMESPACE}
  roleRef:
    name: admin
  subjects:
  - kind: User
    name: ${USER}
  userNames:
  - ${USER}
- kind: ClusterRole
  apiVersion: v1
  metadata:
    annotations:
      authorization.openshift.io/system-only: "true"
      openshift.io/reconcile-protect: "false"
    creationTimestamp: null
    name: prometheus-role
  rules:
  - apiGroups:
    - ""
    attributeRestrictions: null
    resources:
    - secrets
    verbs:
    - get
    - watch
    - list
  - apiGroups:
    - ""
    attributeRestrictions: null
    resources:
    - bindings
    - componentstatuses
    - configmaps
    - endpoints
    - events
    - limitranges
    - namespaces
    - namespaces/status
    - nodes
    - nodes/status
    - persistentvolumeclaims
    - persistentvolumeclaims/status
    - persistentvolumes
    - persistentvolumes/status
    - pods
    - pods/binding
    - pods/eviction
    - pods/log
    - pods/status
    - podtemplates
    - replicationcontrollers
    - replicationcontrollers/scale
    - replicationcontrollers/status
    - resourcequotas
    - resourcequotas/status
    - securitycontextconstraints
    - serviceaccounts
    - services
    - services/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - admissionregistration.k8s.io
    attributeRestrictions: null
    resources:
    - mutatingwebhookconfigurations
    - validatingwebhookconfigurations
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - apps
    attributeRestrictions: null
    resources:
    - controllerrevisions
    - daemonsets
    - daemonsets/status
    - deployments
    - deployments/scale
    - deployments/status
    - replicasets
    - replicasets/scale
    - replicasets/status
    - statefulsets
    - statefulsets/scale
    - statefulsets/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - apiextensions.k8s.io
    attributeRestrictions: null
    resources:
    - customresourcedefinitions
    - customresourcedefinitions/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - apiregistration.k8s.io
    attributeRestrictions: null
    resources:
    - apiservices
    - apiservices/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - autoscaling
    attributeRestrictions: null
    resources:
    - horizontalpodautoscalers
    - horizontalpodautoscalers/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - batch
    attributeRestrictions: null
    resources:
    - cronjobs
    - cronjobs/status
    - jobs
    - jobs/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - extensions
    attributeRestrictions: null
    resources:
    - daemonsets
    - daemonsets/status
    - deployments
    - deployments/scale
    - deployments/status
    - horizontalpodautoscalers
    - horizontalpodautoscalers/status
    - ingresses
    - ingresses/status
    - jobs
    - jobs/status
    - networkpolicies
    - podsecuritypolicies
    - replicasets
    - replicasets/scale
    - replicasets/status
    - replicationcontrollers
    - replicationcontrollers/scale
    - storageclasses
    - thirdpartyresources
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - events.k8s.io
    attributeRestrictions: null
    resources:
    - events
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - networking.k8s.io
    attributeRestrictions: null
    resources:
    - networkpolicies
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - policy
    attributeRestrictions: null
    resources:
    - poddisruptionbudgets
    - poddisruptionbudgets/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - rbac.authorization.k8s.io
    attributeRestrictions: null
    resources:
    - clusterrolebindings
    - clusterroles
    - rolebindings
    - roles
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - settings.k8s.io
    attributeRestrictions: null
    resources:
    - podpresets
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - storage.k8s.io
    attributeRestrictions: null
    resources:
    - storageclasses
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - certificates.k8s.io
    attributeRestrictions: null
    resources:
    - certificatesigningrequests
    - certificatesigningrequests/approval
    - certificatesigningrequests/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - authorization.openshift.io
    attributeRestrictions: null
    resources:
    - clusterrolebindings
    - clusterroles
    - rolebindingrestrictions
    - rolebindings
    - roles
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - build.openshift.io
    attributeRestrictions: null
    resources:
    - buildconfigs
    - buildconfigs/webhooks
    - builds
    - builds/details
    - builds/log
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - apps.openshift.io
    attributeRestrictions: null
    resources:
    - deploymentconfigs
    - deploymentconfigs/log
    - deploymentconfigs/scale
    - deploymentconfigs/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - image.openshift.io
    attributeRestrictions: null
    resources:
    - images
    - imagesignatures
    - imagestreamimages
    - imagestreams
    - imagestreams/status
    - imagestreamtags
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - image.openshift.io
    attributeRestrictions: null
    resources:
    - imagestreams/layers
    verbs:
    - get
  - apiGroups:
    - ""
    - oauth.openshift.io
    attributeRestrictions: null
    resources:
    - oauthclientauthorizations
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - project.openshift.io
    attributeRestrictions: null
    resources:
    - projectrequests
    - projects
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - quota.openshift.io
    attributeRestrictions: null
    resources:
    - appliedclusterresourcequotas
    - clusterresourcequotas
    - clusterresourcequotas/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - route.openshift.io
    attributeRestrictions: null
    resources:
    - routes
    - routes/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - network.openshift.io
    attributeRestrictions: null
    resources:
    - clusternetworks
    - egressnetworkpolicies
    - hostsubnets
    - netnamespaces
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - security.openshift.io
    attributeRestrictions: null
    resources:
    - securitycontextconstraints
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - template.openshift.io
    attributeRestrictions: null
    resources:
    - processedtemplates
    - templateconfigs
    - templateinstances
    - templates
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - template.openshift.io
    attributeRestrictions: null
    resources:
    - brokertemplateinstances
    - templateinstances/status
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - user.openshift.io
    attributeRestrictions: null
    resources:
    - groups
    - identities
    - useridentitymappings
    - users
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    - authorization.openshift.io
    attributeRestrictions: null
    resources:
    - localresourceaccessreviews
    - localsubjectaccessreviews
    - resourceaccessreviews
    - selfsubjectrulesreviews
    - subjectaccessreviews
    - subjectrulesreviews
    verbs:
    - create
  - apiGroups:
    - authorization.k8s.io
    attributeRestrictions: null
    resources:
    - localsubjectaccessreviews
    - selfsubjectaccessreviews
    - selfsubjectrulesreviews
    - subjectaccessreviews
    verbs:
    - create
  - apiGroups:
    - authentication.k8s.io
    attributeRestrictions: null
    resources:
    - tokenreviews
    verbs:
    - create
  - apiGroups:
    - ""
    - security.openshift.io
    attributeRestrictions: null
    resources:
    - podsecuritypolicyreviews
    - podsecuritypolicyselfsubjectreviews
    - podsecuritypolicysubjectreviews
    verbs:
    - create
  - apiGroups:
    - ""
    attributeRestrictions: null
    resources:
    - nodes/metrics
    - nodes/spec
    verbs:
    - get
  - apiGroups:
    - ""
    attributeRestrictions: null
    resources:
    - nodes/stats
    verbs:
    - create
    - get
  - apiGroups: null
    attributeRestrictions: null
    nonResourceURLs:
    - '*'
    resources: []
    verbs:
    - get
  - apiGroups:
    - ""
    - build.openshift.io
    attributeRestrictions: null
    resources:
    - buildlogs
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    attributeRestrictions: null
    resources:
    - resourcequotausages
    verbs:
    - get
    - list
    - watch
- kind: SecurityContextConstraints
  apiVersion: v1
  allowHostDirVolumePlugin: true
  allowHostIPC: true
  allowHostNetwork: true
  allowHostPID: true
  allowHostPorts: true
  allowPrivilegedContainer: true
  allowedCapabilities:
  - '*'
  allowedFlexVolumes: null
  apiVersion: security.openshift.io/v1
  defaultAddCapabilities: null
  fsGroup:
    type: RunAsAny
  groups:
  - system:cluster-admins
  - system:nodes
  - system:masters
  metadata:
    annotations:
      kubernetes.io/description: 'privileged allows access to all privileged and host
        features and the ability to run as any user, any group, any fsGroup, and with
        any SELinux context.  WARNING: this is the most relaxed SCC and should be used
        only for cluster administration. Grant with caution.'
    name: prometheus-privileged
  priority: null
  readOnlyRootFilesystem: false
  requiredDropCapabilities: null
  runAsUser:
    type: RunAsAny
  seLinuxContext:
    type: RunAsAny
  seccompProfiles:
  - '*'
  supplementalGroups:
    type: RunAsAny
  users:
  - system:serviceaccount:${NAMESPACE}:${APPLICATION_NAME}-privileged
  volumes:
  - '*'
- kind: SecurityContextConstraints
  apiVersion: v1
  allowHostDirVolumePlugin: false
  allowHostIPC: false
  allowHostNetwork: false
  allowHostPID: false
  allowHostPorts: false
  allowPrivilegedContainer: false
  allowedCapabilities: null
  allowedFlexVolumes: null
  apiVersion: v1
  defaultAddCapabilities: null
  fsGroup:
    type: RunAsAny
  groups:
  - system:cluster-admins
  metadata:
    annotations:
      kubernetes.io/description: prometheus-anyuid provides all features of the restricted SCC
        but allows users to run with any UID and any GID.
    name: prometheus-anyuid
  priority: 10
  readOnlyRootFilesystem: false
  requiredDropCapabilities:
  - MKNOD
  runAsUser:
    type: RunAsAny
  seLinuxContext:
    type: MustRunAs
  supplementalGroups:
    type: RunAsAny
  users:
  - system:serviceaccount:${NAMESPACE}:${APPLICATION_NAME}-user
  volumes:
  - configMap
  - downwardAPI
  - emptyDir
  - persistentVolumeClaim
  - projected
  - secret
- kind: ClusterRoleBinding
  apiVersion: v1
  metadata:
    name: prometheus-role-bind
  roleRef:
    name: prometheus-role
  subjects:
  - kind: ServiceAccount
    name: ${APPLICATION_NAME}-user
    namespace: ${NAMESPACE}
  userNames:
  - system:serviceaccount:${NAMESPACE}:${APPLICATION_NAME}-user
- kind: Secret
  apiVersion: v1
  stringData:
    admin-password: ${GRAFANA_PASSWORD}
    admin-username: admin
  metadata:
    name: grafana
  type: Opaque
- kind: PersistentVolumeClaim
  apiVersion: v1
  metadata:
    name: grafana-data
  spec:
    accessModes:
    - ReadWriteOnce
    resources:
      requests:
        storage: ${GRAFANA_DATA_VOL_SIZE}
- kind: DaemonSet
  apiVersion: extensions/v1beta1
  metadata:
    labels:
      app: prometheus
      component: node-exporter
    name: prometheus-node-exporter
  spec:
    template:
      metadata:
        name: prometheus-node-exporter
        labels:
          app: prometheus
          component: node-exporter
      spec:
        containers:
          - image: quay.io/prometheus/node-exporter:v0.15.0
            imagePullPolicy: IfNotPresent
            name: prometheus-node-exporter
            ports:
              - containerPort: 9100
                hostPort: 9100
                name: prom-node-exp
                protocol: TCP
            resources: {}
            terminationMessagePath: /dev/termination-log
            terminationMessagePolicy: File
        dnsPolicy: ClusterFirst
        hostNetwork: true
        hostPID: true
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
        serviceAccount: "${APPLICATION_NAME}-privileged"
    templateGeneration: 1
    updateStrategy:
      type: OnDelete
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    labels:
      app: grafana
      component: core
    name: grafana-core
  spec:
    replicas: 1
    selector:
      app: grafana
      component: core
    strategy:
      activeDeadlineSeconds: 21600
      resources: {}
      rollingParams:
        post:
          execNewPod:
            command:
              - /bin/sh
              - /var/tmp/import-script/import.sh
            containerName: grafana-core
            volumes:
            - grafana-datasource-vol
            - grafana-dsh-haproxy-vol
            - grafana-dsh-cluster-resources-vol
            - grafana-dsh-go-metrics-vol
            - grafana-dsh-infra-overview-vol
            - grafana-dsh-node-status-vol
            - grafana-dsh-pod-resources-vol
            - import-script-vol
          failurePolicy: ignore
        intervalSeconds: 1
        maxSurge: 25%
        maxUnavailable: 25%
        timeoutSeconds: 600
        updatePeriodSeconds: 1
      type: Rolling
    template:
      metadata:
        labels:
          app: grafana
          component: core
      spec:
        containers:
        - env:
          - name: GF_AUTH_BASIC_ENABLED
            value: "true"
          - name: GF_USERS_ALLOW_SIGN_UP
            value: "false"
          - name: GF_SECURITY_ADMIN_USER
            valueFrom:
              secretKeyRef:
                key: admin-username
                name: grafana
          - name: GF_SECURITY_ADMIN_PASSWORD
            valueFrom:
              secretKeyRef:
                key: admin-password
                name: grafana
          - name: GF_AUTH_ANONYMOUS_ENABLED
            value: "false"
          image: docker.io/grafana/grafana:5.0.4
          imagePullPolicy: IfNotPresent
          name: grafana-core
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /login
              port: 3000
              scheme: HTTP
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 1000m
              memory: 1000Mi
            requests:
              cpu: 100m
              memory: 100Mi
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /var/lib/grafana
            name: grafana-persistent-storage
          - mountPath: /var/tmp/prometheus-datasource
            name: grafana-datasource-vol
          - mountPath: /var/tmp/HAProxy
            name: grafana-dsh-haproxy-vol
          - mountPath: /var/tmp/cluster-resources
            name: grafana-dsh-cluster-resources-vol
          - mountPath: /var/tmp/go-metrics
            name: grafana-dsh-go-metrics-vol
          - mountPath: /var/tmp/infra-overview
            name: grafana-dsh-infra-overview-vol
          - mountPath: /var/tmp/node-status
            name: grafana-dsh-node-status-vol
          - mountPath: /var/tmp/pods-resources
            name: grafana-dsh-pod-resources-vol
          - mountPath: /var/tmp/import-script
            name: import-script-vol
        dnsPolicy: ClusterFirst
        serviceAccount: "${APPLICATION_NAME}-user"
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
        volumes:
        - name: grafana-persistent-storage
          persistentVolumeClaim:
            claimName: grafana-data
        - configMap:
            defaultMode: 420
            name: grafana-datasource
            items:
              - key: prometheus-datasource.json
                path: prometheus-datasource.json
          name: grafana-datasource-vol
        - configMap:
            defaultMode: 420
            name: grafana-dsh-haproxy
            items:
              - key: HAProxy.json
                path: HAProxy.json
          name: grafana-dsh-haproxy-vol
        - configMap:
            defaultMode: 420
            name: grafana-dsh-cluster-resources
            items:
              - key: cluster-resources.json
                path: cluster-resources.json
          name: grafana-dsh-cluster-resources-vol
        - configMap:
            defaultMode: 420
            name: grafana-dsh-go-metrics
            items:
              - key: go-metrics.json
                path: go-metrics.json
          name: grafana-dsh-go-metrics-vol
        - configMap:
            defaultMode: 420
            name: grafana-dsh-infra-overview
            items:
              - key: infra-overview.json
                path: infra-overview.json
          name: grafana-dsh-infra-overview-vol
        - configMap:
            defaultMode: 420
            name: grafana-dsh-node-status
            items:
              - key: node-status.json
                path: node-status.json
          name: grafana-dsh-node-status-vol
        - configMap:
            defaultMode: 420
            name: grafana-dsh-pod-resources
            items:
              - key: pods-resources.json
                path: pods-resources.json
          name: grafana-dsh-pod-resources-vol
        - configMap:
            defaultMode: 420
            name: import-script
            items:
              - key: import.sh
                path: import.sh
          name: import-script-vol
    test: false
    triggers:
    - type: ConfigChange
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: kube-state-metrics
  spec:
    replicas: 1
    selector:
      app: kube-state-metrics
      version: v1.1.0
    strategy:
      activeDeadlineSeconds: 21600
      resources: {}
      rollingParams:
        intervalSeconds: 1
        maxSurge: 25%
        maxUnavailable: 25%
        timeoutSeconds: 600
        updatePeriodSeconds: 1
      type: Rolling
    template:
      metadata:
        labels:
          app: kube-state-metrics
          version: v1.1.0
      spec:
        containers:
        - image: gcr.io/google_containers/kube-state-metrics:v1.3.1
          imagePullPolicy: IfNotPresent
          name: kube-state-metrics
          ports:
          - containerPort: 8080
            protocol: TCP
          resources: {}
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
        dnsPolicy: ClusterFirst
        serviceAccount: "${APPLICATION_NAME}-user"
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
    test: false
    triggers:
    - type: ConfigChange
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    annotations:
    labels:
      app: prometheus
      component: core
    name: prometheus-core
  spec:
    replicas: 1
    selector:
      app: prometheus
      component: core
    strategy:
      activeDeadlineSeconds: 21600
      resources: {}
      rollingParams:
        intervalSeconds: 1
        maxSurge: 25%
        maxUnavailable: 25%
        timeoutSeconds: 600
        updatePeriodSeconds: 1
      type: Rolling
    template:
      metadata:
        labels:
          app: prometheus
          component: core
        name: prometheus-main
      spec:
        containers:
        - args:
          - --config.file=/etc/prometheus/prometheus.yml
          image: quay.io/prometheus/prometheus:v2.3.1
          imagePullPolicy: IfNotPresent
          name: prometheus
          ports:
          - containerPort: 9090
            name: webui
            protocol: TCP
          resources:
            limits:
              cpu: 1000m
              memory: 1000M
            requests:
              cpu: 500m
              memory: 500M
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /etc/prometheus
            name: config-volume
        dnsPolicy: ClusterFirst
        serviceAccount: "${APPLICATION_NAME}-user"
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 420
            name: prometheus-core
          name: config-volume
    test: false
    triggers:
    - type: ConfigChange
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: alert-manager
  spec:
    replicas: 1
    selector:
      app: alert-manager
    strategy:
      activeDeadlineSeconds: 21600
      resources: {}
      rollingParams:
        intervalSeconds: 1
        maxSurge: 25%
        maxUnavailable: 25%
        timeoutSeconds: 600
        updatePeriodSeconds: 1
      type: Rolling
    template:
      metadata:
        labels:
          app: alert-manager
      spec:
        containers:
        - image: quay.io/prometheus/alertmanager:v0.15.0
          imagePullPolicy: IfNotPresent
          name: alert-manager
          ports:
          - containerPort: 9093
            protocol: TCP
          resources: {}
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - name: config-volume
            mountPath: /etc/alertmanager
        volumes:
        - configMap:
            defaultMode: 420
            name: alertmanager-config
          name: config-volume
        dnsPolicy: ClusterFirst
        serviceAccount: "${APPLICATION_NAME}-user"
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
    test: false
    triggers:
    - type: ConfigChange
- kind: Route
  apiVersion: v1
  metadata:
    labels:
      app: grafana
      component: core
    name: grafana
  spec:
    host: "${GRAFANA_APPLICATION_HOSTNAME}"
    to:
      kind: Service
      name: grafana
      weight: 100
    wildcardPolicy: None
- kind: Route
  apiVersion: v1
  metadata:
    labels:
      app: alert-manager
    name: alert-manager
  spec:
    host: "${ALERTMANAGER_APPLICATION_HOSTNAME}"
    port:
      targetPort: webui
    to:
      kind: Service
      name: alert-manager
      weight: 100
    wildcardPolicy: None
- kind: Route
  apiVersion: v1
  metadata:
    labels:
      app: prometheus
      component: core
    name: prometheus
  spec:
    host: "${PROMETHEUS_APPLICATION_HOSTNAME}"
    port:
      targetPort: webui
    to:
      kind: Service
      name: prometheus
      weight: 100
    wildcardPolicy: None
- kind: Service
  apiVersion: v1
  metadata:
    labels:
      app: alert-manager
    name: alert-manager
  spec:
    ports:
    - port: 9093
      name: webui
      protocol: TCP
      targetPort: 9093
    selector:
      app: alert-manager
    sessionAffinity: None
    type: ClusterIP
- kind: Service
  apiVersion: v1
  metadata:
    labels:
      app: grafana
      component: core
    name: grafana
  spec:
    ports:
    - port: 3000
      protocol: TCP
      targetPort: 3000
    selector:
      app: grafana
      component: core
    sessionAffinity: None
    type: ClusterIP
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: alertmanager-config
  data:
    alertmanager.yml: |
      global:                                                                                                                                                                                                                            
        resolve_timeout: 5m

      route:                                                                                                                                                                                                                             
        group_by: ['alertname', 'cluster', 'service']                                                                                                                                                                                                          
        group_wait: 10s                                                                                                                                                                                                                  
        group_interval: 10s                                                                                                                                                                                                              
        repeat_interval: 1h                                                                                                                                                                                                              
        receiver: rocketchat 

      receivers:                                                                                                                                                                                                                         
      - name: 'rocketchat'
        webhook_configs:
        - send_resolved: true
          url: ${RC_WEBHOOK}    

      inhibit_rules:                                                                                                                                                                                                                     
      - source_match:                                                                                                                                                                                                                  
          severity: 'critical'                                                                                                                                                                                                         
        target_match:                                                                                                                                                                                                                  
          severity: 'warning'                                                                                                                                                                                                          
        equal: ['alertname', 'cluster', 'service']
- kind: ConfigMap
  apiVersion: v1
  data:
    alert.rules.yml: |
      groups:
      - name: alert.rules
        rules:
        - alert: node_down
          expr: up{job="kubernetes-nodes"} == 0
          for: 5m
          annotations:
            description: Node has been unreachable for more than 5 minutes.
            severity: crtitical
            summary: Node is down
        - alert: cpu_usage
          expr: 100 - (avg by (instance) (irate(node_cpu{mode="idle"}[10m])) * 100) > 80 
          for: 10m
          annotations:
            description: Node CPU usage has been beyond 80% for more than 10 minutes.
            severity: critical
            summary: High CPU usage
        - alert: memory_usage
          expr: ((node_memory_MemTotal - node_memory_MemFree - node_memory_Cached - node_memory_Buffers - node_memory_Slab) / node_memory_MemTotal) * 100 > 80 
          for: 10m
          annotations:
            description: Node Memory usage has been beyond 80% for more than 10 minutes.
            severity: critical
            summary: High Memory usage
    prometheus.yml: >
      # Global configurations

      global:
        scrape_interval: 30s
        scrape_timeout: 30s

      rule_files:
        - "/etc/prometheus/alert.rules.yml"

      # A scrape configuration for running Prometheus on a Kubernetes cluster.

      # This uses separate scrape configs for cluster components (i.e. API server

      # and services to allow each to use different authentication configs.

      #

      # Kubernetes labels will be added as Prometheus labels on metrics via the

      # `labelmap` relabeling action.


      # Scrape config for API servers.

      #

      # Kubernetes exposes API servers as endpoints to the default/kubernetes

      # service so this uses `endpoints` role and uses relabelling to only keep

      # the endpoints associated with the default/kubernetes service using the

      # default named port `https`. This works for single API server deployments

      # well as HA API server deployments.

      scrape_configs:

      - job_name: 'kubernetes-apiservers'

        kubernetes_sd_configs:
        - role: endpoints

        # Default to scraping over https. If required, just disable this or change to
        # `http`.
        scheme: https

        # This TLS & bearer token file config is used to connect to the actual scrape
        # endpoints for cluster components. This is separate to discovery auth
        # configuration because discovery & scraping are two separate concerns in
        # Prometheus. The discovery auth config is automatic if Prometheus runs inside
        # the cluster. Otherwise, more config options have to be provided within the
        # <kubernetes_sd_config>.
        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
          # If your node certificates are self-signed or use a different CA to the
          # master CA, then disable certificate verification below. Note that
          # certificate verification is an integral part of a secure infrastructure
          # so this should only be disabled in a controlled environment. You can
          # disable certificate verification by uncommenting the line below.
          #
          # insecure_skip_verify: true
        bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token

        # Keep only the default/kubernetes service endpoints for the https port. This
        # will add targets for each API server which Kubernetes adds an endpoint to
        # the default/kubernetes service.
        relabel_configs:
        - source_labels: [__meta_kubernetes_namespace, __meta_kubernetes_service_name, __meta_kubernetes_endpoint_port_name]
          action: keep
          regex: default;kubernetes;https

      # Scrape config for nodes.

      #

      # Each node exposes a /metrics endpoint that contains operational metrics
      for

      # the Kubelet and other components.

      - job_name: 'kubernetes-nodes'

        # Default to scraping over https. If required, just disable this or change to
        # `http`.
        scheme: https

        # This TLS & bearer token file config is used to connect to the actual scrape
        # endpoints for cluster components. This is separate to discovery auth
        # configuration because discovery & scraping are two separate concerns in
        # Prometheus. The discovery auth config is automatic if Prometheus runs inside
        # the cluster. Otherwise, more config options have to be provided within the
        # <kubernetes_sd_config>.
        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
          # If your node certificates are self-signed or use a different CA to the
          # master CA, then disable certificate verification below. Note that
          # certificate verification is an integral part of a secure infrastructure
          # so this should only be disabled in a controlled environment. You can
          # disable certificate verification by uncommenting the line below.
          #
          # insecure_skip_verify: true
        bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token

        kubernetes_sd_configs:
        - role: node

        relabel_configs:
        - action: labelmap
          regex: __meta_kubernetes_node_label_(.+)

      # Scrape config for controllers (for OCP 3.7).

      #

      # Each master node exposes a /metrics endpoint on :8444 that contains
      operational metrics for

      # the controllers.

      #

      # TODO: move this to a pure endpoints based metrics gatherer when
      controllers are exposed via

      #       endpoints.

      # - job_name: 'kubernetes-controllers'

      #

      #   scheme: https

      #   tls_config:

      #     ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt

      #   bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token

      #

      #   kubernetes_sd_configs:

      #   - role: endpoints

      #

      #   # Keep only the default/kubernetes service endpoints for the https port,
      and then

      #   # set the port to 8444. This is the default configuration for the
      controllers on OpenShift

      #   # masters.

      #   relabel_configs:

      #   - source_labels: [__meta_kubernetes_namespace,
      __meta_kubernetes_service_name, __meta_kubernetes_endpoint_port_name]

      #     action: keep

      #     regex: default;kubernetes;https

      #   - source_labels: [__address__]

      #     action: replace

      #     target_label: __address__

      #     regex: (.+)(?::\d+)

      #     replacement: $1:8444


      # Scrape config for cAdvisor (for OCP 3.7).

      #

      # Beginning in Kube 1.7, each node exposes a /metrics/cadvisor endpoint that

      # reports container metrics for each running pod. Scrape those by default.

      # - job_name: 'kubernetes-cadvisor'

      #

      #   scheme: https

      #   tls_config:

      #     ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt

      #   bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token

      #

      #   metrics_path: /metrics/cadvisor

      #

      #   kubernetes_sd_configs:

      #   - role: node

      #

      #   relabel_configs:

      #   - action: labelmap

      #     regex: __meta_kubernetes_node_label_(.+)



      # Scrape config for service endpoints.

      #

      # The relabeling allows the actual service scrape endpoint to be configured

      # via the following annotations:

      #

      # * `prometheus.io/scrape`: Only scrape services that have a value of `true`

      # * `prometheus.io/scheme`: If the metrics endpoint is secured then you will
      need

      # to set this to `https` & most likely set the `tls_config` of the scrape
      config.

      # * `prometheus.io/path`: If the metrics path is not `/metrics` override
      this.

      # * `prometheus.io/port`: If the metrics are exposed on a different port to
      the

      # service then set this appropriately.

      - job_name: 'kubernetes-service-endpoints'

        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
          # TODO: this should be per target
          insecure_skip_verify: true

        kubernetes_sd_configs:
        - role: endpoints

        relabel_configs:
        - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_scrape]
          action: keep
          regex: true
        - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_scheme]
          action: replace
          target_label: __scheme__
          regex: (https?)
        - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_path]
          action: replace
          target_label: __metrics_path__
          regex: (.+)
        - source_labels: [__address__, __meta_kubernetes_service_annotation_prometheus_io_port]
          action: replace
          target_label: __address__
          regex: (.+)(?::\d+);(\d+)
          replacement: $1:$2
        - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_username]
          action: replace
          target_label: __basic_auth_username__
          regex: (.+)
        - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_password]
          action: replace
          target_label: __basic_auth_password__
          regex: (.+)
        - action: labelmap
          regex: __meta_kubernetes_service_label_(.+)
        - source_labels: [__meta_kubernetes_namespace]
          action: replace
          target_label: kubernetes_namespace
        - source_labels: [__meta_kubernetes_service_name]
          action: replace
          target_label: kubernetes_name

      # Scrape Config for Node Exporters running on individual nodes

      # These Note Exporters can be run either as a Daemon Set in the OpenShift

      # Cluster or natively. Regardless of deployment they will listen on Port
      9100

      # which has to open in the Firewall.

      - job_name: 'node-exporters'
        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
          insecure_skip_verify: true
        kubernetes_sd_configs:
        - role: node
        relabel_configs:
        - action: labelmap
          regex: __meta_kubernetes_node_label_(.+)
        - source_labels: [__meta_kubernetes_role]
          action: replace
          target_label: kubernetes_role
        - source_labels: [__address__]
          regex: '(.*):10250'
          replacement: '${1}:9100'
          target_label: __address__

      # Scrape config for cAdvisor.

      #

      # Beginning in Kube 1.7, each node exposes a /metrics/cadvisor endpoint that

      # reports container metrics for each running pod. Scrape those by default.

      - job_name: 'kubernetes-cadvisor'

        scheme: https
        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
        bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token

        metrics_path: /metrics/cadvisor

        kubernetes_sd_configs:
        - role: node

        relabel_configs:
        - action: labelmap
          regex: __meta_kubernetes_node_label_(.+)

      # Scrape Config for HA Proxy (OpenShift Routers) running on the

      # OpenShift Cluster (this works from OpenShift 3.6 and on).

      # Port 1936 needs to be open in the Firewall on the nodes (Infranodes)

      # Router(s) are running.

      # This Job requires basic authentication. Username is always "admin".

      # Actual password can be found out by running the command:

      #   oc set env dc router -n default --list|grep STATS_PASSWORD

      - job_name: 'openshift-routers'
        metrics_path: '/metrics'
        scheme: http
        basic_auth:
          username: admin
          password: ${HAPROXY_STATS_PASSWORD}
        static_configs:
        - targets: ['router.default.svc.cluster.local:1936']

      alerting:
        alertmanagers:
          - scheme: http
            static_configs:
            - targets:
              - "alert-manager:9093"
  metadata:
    name: prometheus-core
- kind: Service
  apiVersion: v1
  metadata:
    annotations:
      prometheus.io/scrape: "true"
    labels:
      app: kube-state-metrics
    name: kube-state-metrics
  spec:
    ports:
    - name: kube-state-metrics
      port: 8080
      protocol: TCP
      targetPort: 8080
    selector:
      app: kube-state-metrics
    sessionAffinity: None
    type: ClusterIP
- kind: Service
  apiVersion: v1
  metadata:
    annotations:
      prometheus.io/scheme: http
      prometheus.io/scrape: "true"
    labels:
      app: prometheus
      component: core
    name: prometheus
  spec:
    ports:
    - name: webui
      port: 9090
      protocol: TCP
      targetPort: 9090
    selector:
      app: prometheus
      component: core
    sessionAffinity: None
    type: ClusterIP
- kind: Service
  apiVersion: v1
  metadata:
    annotations:
      prometheus.io/scrape: "true"
    labels:
      app: prometheus
      component: node-exporter
    name: prometheus-node-exporter
  spec:
    ports:
    - name: prometheus-node-exporter
      port: 9100
      protocol: TCP
      targetPort: 9100
    selector:
      app: prometheus
      component: node-exporter
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: grafana-datasource
  data:
    prometheus-datasource.json: |-
      {
        "name":"prometheus",
        "type":"prometheus",
        "url":"http://prometheus.${NAMESPACE}.svc.cluster.local:9090",
        "access":"proxy",
        "basicAuth":false
      }
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: grafana-dsh-haproxy
  data:
    HAProxy.json: |-
        {
          "dashboard": {
          "description": "HAProxy backend servers",
          "editable": true,
          "links": [],
          "panels": [
            {
              "collapsed": false,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 0
              },
              "id": 86,
              "panels": [],
              "repeat": null,
              "title": "Basic Backend status",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "decimals": 0,
              "fill": 7,
              "gridPos": {
                "h": 4,
                "w": 24,
                "x": 0,
                "y": 1
              },
              "id": 85,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": true,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 3,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "Backends Down",
                  "color": "#890F02"
                },
                {
                  "alias": "Backends Down",
                  "transform": "negative-Y"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "count(haproxy_backend_up{route=~\"$route\", instance=~\"$host:$port\"} == 1)",
                  "format": "time_series",
                  "hide": false,
                  "interval": "$interval",
                  "intervalFactor": 2,
                  "legendFormat": "Backends Up",
                  "refId": "A",
                  "step": 60
                },
                {
                  "expr": "count(haproxy_backend_up{route=~\"$route\",instance=~\"$host:$port\"} == 0)",
                  "format": "time_series",
                  "interval": "$interval",
                  "intervalFactor": 2,
                  "legendFormat": "Backends Down",
                  "refId": "B",
                  "step": 60
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Backends Up / Down",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "transparent": false,
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": false
                }
              ]
            },
            {
              "collapsed": false,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 5
              },
              "id": 87,
              "panels": [],
              "repeat": null,
              "title": "Basic General Info",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 10,
                "w": 24,
                "x": 0,
                "y": 6
              },
              "id": 83,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": true,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 12,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*Back.*/",
                  "transform": "negative-Y"
                },
                {
                  "alias": "/.*1.*/",
                  "color": "#6ED0E0"
                },
                {
                  "alias": "/.*2.*/",
                  "color": "#7EB26D"
                },
                {
                  "alias": "/.*3.*/",
                  "color": "#1F78C1"
                },
                {
                  "alias": "/.*4.*/",
                  "color": "#CCA300"
                },
                {
                  "alias": "/.*5.*/",
                  "color": "#890F02"
                },
                {
                  "alias": "/.*other.*/",
                  "color": "#806EB7"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(haproxy_frontend_http_responses_total{frontend=~\"$frontend\",code=~\"$code\",instance=~\"$host:$port\"}[5m])) by (code)",
                  "format": "time_series",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "Frontend {{ code }}",
                  "metric": "",
                  "refId": "A",
                  "step": 30
                },
                {
                  "expr": "sum(rate(haproxy_backend_http_responses_total{backend=~\"$backend\",code=~\"$code\",instance=~\"$host:$port\"}[5m])) by (code)",
                  "format": "time_series",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "Backend {{ code }}",
                  "metric": "",
                  "refId": "B",
                  "step": 30
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Total responses by HTTP code",
              "tooltip": {
                "msResolution": true,
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "transparent": false,
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "decimals": 1,
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 10,
                "w": 12,
                "x": 0,
                "y": 16
              },
              "id": 75,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 12,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*OUT.*/",
                  "transform": "negative-Y"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(haproxy_frontend_bytes_in_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[5m])*8) by (instance)",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "IN Front",
                  "metric": "",
                  "refId": "A",
                  "step": 30
                },
                {
                  "expr": "sum(rate(haproxy_frontend_bytes_out_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[5m])*8) by (instance)",
                  "interval": "$interval",
                  "intervalFactor": 2,
                  "legendFormat": "OUT Front",
                  "refId": "B",
                  "step": 60
                },
                {
                  "expr": "sum(rate(haproxy_backend_bytes_in_total{backend=~\"$backend\",instance=~\"$host:$port\"}[5m])*8) by (instance)",
                  "intervalFactor": 2,
                  "legendFormat": "IN Back",
                  "refId": "C",
                  "step": 240
                },
                {
                  "expr": "sum(rate(haproxy_backend_bytes_out_total{backend=~\"$backend\",instance=~\"$host:$port\"}[5m])*8) by (instance)",
                  "intervalFactor": 2,
                  "legendFormat": "OUT Back",
                  "refId": "D",
                  "step": 240
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Current total of incoming / outgoing bytes",
              "tooltip": {
                "msResolution": true,
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bps",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 10,
                "w": 12,
                "x": 12,
                "y": 16
              },
              "id": 79,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 12,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*Back.*/",
                  "transform": "negative-Y"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(deriv(haproxy_frontend_connections_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[5m])) by (instance)",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "Front",
                  "metric": "",
                  "refId": "A",
                  "step": 30
                },
                {
                  "expr": "sum(deriv(haproxy_backend_connections_total{backend=~\"$backend\",instance=~\"$host:$port\"}[5m])) by (instance)",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "Back",
                  "metric": "",
                  "refId": "B",
                  "step": 30
                },
                {
                  "expr": "sum(deriv(haproxy_backend_connection_errors_total{backend=~\"$backend\",instance=~\"$host:$port\"}[5m])) by (instance)",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "Back errors",
                  "metric": "",
                  "refId": "C",
                  "step": 30
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Total number of connections",
              "tooltip": {
                "msResolution": true,
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "none",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "collapsed": false,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 26
              },
              "id": 88,
              "panels": [],
              "repeat": null,
              "title": "Throughput",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "decimals": 1,
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 10,
                "w": 12,
                "x": 0,
                "y": 27
              },
              "id": 42,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 12,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*OUT.*/",
                  "transform": "negative-Y"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "rate(haproxy_frontend_bytes_in_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[5m])*8",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "IN-{{ frontend }}",
                  "metric": "",
                  "refId": "A",
                  "step": 30
                },
                {
                  "expr": "rate(haproxy_frontend_bytes_out_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[5m])*8",
                  "interval": "$interval",
                  "intervalFactor": 2,
                  "legendFormat": "OUT-{{ frontend }}",
                  "refId": "B",
                  "step": 60
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Front - Current total of incoming / outgoing bytes",
              "tooltip": {
                "msResolution": true,
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bps",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 10,
                "w": 12,
                "x": 12,
                "y": 27
              },
              "id": 84,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 12,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*Back.*/",
                  "transform": "negative-Y"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(haproxy_frontend_current_sessions{frontend=~\"$frontend\",instance=~\"$host:$port\"}) by (instance)",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "Frontend current sessions",
                  "metric": "",
                  "refId": "B",
                  "step": 30
                },
                {
                  "expr": "sum(haproxy_frontend_current_session_rate{frontend=~\"$frontend\",instance=~\"$host:$port\"}) by (instance)",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "Frontend current session rate",
                  "metric": "",
                  "refId": "C",
                  "step": 30
                },
                {
                  "expr": "sum(haproxy_backend_current_sessions{backend=~\"$backend\",instance=~\"$host:$port\"}) by (instance)",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "Backend current sessions",
                  "metric": "",
                  "refId": "A",
                  "step": 30
                },
                {
                  "expr": "sum(haproxy_backend_current_session_rate{backend=~\"$backend\",instance=~\"$host:$port\"}) by (instance)",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "Backend current session rate",
                  "metric": "",
                  "refId": "D",
                  "step": 30
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Sessions",
              "tooltip": {
                "msResolution": true,
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "transparent": false,
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "collapsed": false,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 37
              },
              "id": 89,
              "panels": [],
              "repeat": null,
              "title": "Connections",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 11,
                "w": 12,
                "x": 0,
                "y": 38
              },
              "id": 43,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 12,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "deriv(haproxy_frontend_connections_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[5m])",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "{{ frontend }}",
                  "metric": "haproxy_backe",
                  "refId": "B",
                  "step": 30
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Front - Total number of connections",
              "tooltip": {
                "msResolution": true,
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "none",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "collapsed": true,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 49
              },
              "id": 90,
              "panels": [
                {
                  "aliasColors": {},
                  "bars": false,
                  "datasource": "prometheus",
                  "description": "",
                  "editable": true,
                  "error": false,
                  "fill": 2,
                  "grid": {},
                  "gridPos": {
                    "h": 11,
                    "w": 12,
                    "x": 0,
                    "y": 50
                  },
                  "id": 24,
                  "legend": {
                    "alignAsTable": true,
                    "avg": true,
                    "current": true,
                    "max": true,
                    "min": true,
                    "rightSide": false,
                    "show": true,
                    "total": false,
                    "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "links": [],
                  "minSpan": 12,
                  "nullPointMode": "null",
                  "percentage": false,
                  "pointradius": 5,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                    {
                      "expr": "rate(haproxy_backend_http_responses_total{backend=~\"$backend\", code=~\"$code\",instance=~\"$host:$port\"}[5m])",
                      "interval": "$interval",
                      "intervalFactor": 1,
                      "legendFormat": "{{ code }} {{ backend }}",
                      "metric": "",
                      "refId": "A",
                      "step": 30
                    }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Back - Total of HTTP responses",
                  "tooltip": {
                    "msResolution": true,
                    "shared": true,
                    "sort": 2,
                    "value_type": "individual"
                  },
                  "transparent": false,
                  "type": "graph",
                  "xaxis": {
                    "mode": "time",
                    "name": null,
                    "show": true,
                    "values": []
                  },
                  "yaxes": [
                    {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": 0,
                      "show": true
                    },
                    {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": 0,
                      "show": false
                    }
                  ]
                },
                {
                  "aliasColors": {},
                  "bars": false,
                  "datasource": "prometheus",
                  "description": "",
                  "editable": true,
                  "error": false,
                  "fill": 2,
                  "grid": {},
                  "gridPos": {
                    "h": 11,
                    "w": 12,
                    "x": 12,
                    "y": 50
                  },
                  "id": 47,
                  "legend": {
                    "alignAsTable": true,
                    "avg": true,
                    "current": true,
                    "max": true,
                    "min": true,
                    "rightSide": false,
                    "show": true,
                    "total": false,
                    "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "links": [],
                  "minSpan": 12,
                  "nullPointMode": "null",
                  "percentage": false,
                  "pointradius": 5,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                    {
                      "expr": "deriv(haproxy_frontend_http_responses_total{frontend=~\"$frontend\", code=~\"$code\",instance=~\"$host:$port\"}[5m])",
                      "interval": "$interval",
                      "intervalFactor": 1,
                      "legendFormat": "{{ code }} {{ frontend }} ",
                      "metric": "",
                      "refId": "A",
                      "step": 30
                    }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Front - Total of HTTP responses",
                  "tooltip": {
                    "msResolution": true,
                    "shared": true,
                    "sort": 2,
                    "value_type": "individual"
                  },
                  "transparent": false,
                  "type": "graph",
                  "xaxis": {
                    "mode": "time",
                    "name": null,
                    "show": true,
                    "values": []
                  },
                  "yaxes": [
                    {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": 0,
                      "show": true
                    },
                    {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": 0,
                      "show": false
                    }
                  ]
                }
              ],
              "repeat": null,
              "title": "Responses by HTTP code",
              "type": "row"
            },
            {
              "collapsed": false,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 50
              },
              "id": 91,
              "panels": [],
              "repeat": null,
              "title": "Sessions",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 10,
                "w": 12,
                "x": 0,
                "y": 51
              },
              "id": 45,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 12,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "haproxy_frontend_current_sessions{frontend=~\"$frontend\",instance=~\"$host:$port\"}",
                  "hide": false,
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "{{ frontend }}",
                  "metric": "haproxy_backend_current_queue",
                  "refId": "A",
                  "step": 30
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Front - Current number of active sessions",
              "tooltip": {
                "msResolution": true,
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 10,
                "w": 12,
                "x": 12,
                "y": 51
              },
              "id": 44,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 12,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "haproxy_frontend_current_session_rate{frontend=~\"$frontend\",instance=~\"$host:$port\"}",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "{{ frontend }}",
                  "metric": "",
                  "refId": "A",
                  "step": 30
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Front - Current number of sessions rate per second over last elapsed second",
              "tooltip": {
                "msResolution": true,
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 10,
                "w": 12,
                "x": 0,
                "y": 61
              },
              "id": 51,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 6,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*limit.*/",
                  "fill": 0
                }
              ],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "haproxy_frontend_max_sessions{frontend=~\"$frontend\",instance=~\"$host:$port\"}",
                  "hide": false,
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "{{ frontend }}",
                  "metric": "",
                  "refId": "A",
                  "step": 30
                },
                {
                  "expr": "haproxy_frontend_limit_sessions{frontend=~\"$frontend\",instance=~\"$host:$port\"}",
                  "intervalFactor": 2,
                  "legendFormat": "{{ frontend }} limit",
                  "refId": "B",
                  "step": 240
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Front - Maximum observed number of active sessions and limit",
              "tooltip": {
                "msResolution": true,
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 10,
                "w": 12,
                "x": 12,
                "y": 61
              },
              "id": 69,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 8,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*limit.*/",
                  "fill": 0
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "haproxy_frontend_max_session_rate{frontend=~\"$frontend\",instance=~\"$host:$port\"}",
                  "hide": false,
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "{{ frontend }}",
                  "metric": "",
                  "refId": "A",
                  "step": 30
                },
                {
                  "expr": "haproxy_frontend_limit_session_rate{frontend=~\"$frontend\",instance=~\"$host:$port\"}",
                  "intervalFactor": 2,
                  "legendFormat": "{{ frontend }} limit",
                  "refId": "B",
                  "step": 240
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Front - Maximum number of sessions rate per second and limit",
              "tooltip": {
                "msResolution": true,
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "collapsed": false,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 71
              },
              "id": 92,
              "panels": [],
              "repeat": null,
              "title": "By Server Throughput",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "decimals": 1,
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 15,
                "w": 24,
                "x": 0,
                "y": 72
              },
              "id": 54,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 24,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*OUT.*/",
                  "transform": "negative-Y"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "rate(haproxy_server_bytes_in_total{route=~\"$route\",server=~\"$server\",instance=~\"$host:$port\"}[5m])*8",
                  "format": "time_series",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "IN-{{ backend }} / {{ server }}",
                  "metric": "",
                  "refId": "A",
                  "step": 30
                },
                {
                  "expr": "rate(haproxy_server_bytes_out_total{route=~\"$route\",server=~\"$server\",instance=~\"$host:$port\"}[5m])*8",
                  "format": "time_series",
                  "interval": "$interval",
                  "intervalFactor": 2,
                  "legendFormat": "OUT-{{ backend }} / {{ server }}",
                  "refId": "B",
                  "step": 60
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Server - Current total of incoming / outgoing bytes",
              "tooltip": {
                "msResolution": true,
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bps",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "collapsed": false,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 87
              },
              "id": 93,
              "panels": [],
              "repeat": null,
              "title": "By Server Connections",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 11,
                "w": 24,
                "x": 0,
                "y": 88
              },
              "id": 58,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 24,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "deriv(haproxy_server_connections_total{route=~\"$route\",instance=~\"$host:$port\"}[5m])",
                  "format": "time_series",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "{{ backend }} / {{ server }}",
                  "metric": "haproxy_backe",
                  "refId": "B",
                  "step": 30
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Server - Total number of connections",
              "tooltip": {
                "msResolution": true,
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "none",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "collapsed": true,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 99
              },
              "id": 94,
              "panels": [
                {
                  "aliasColors": {},
                  "bars": false,
                  "datasource": "prometheus",
                  "editable": true,
                  "error": false,
                  "fill": 2,
                  "grid": {},
                  "gridPos": {
                    "h": 10,
                    "w": 24,
                    "x": 0,
                    "y": 100
                  },
                  "height": "400px",
                  "id": 64,
                  "legend": {
                    "alignAsTable": true,
                    "avg": true,
                    "current": true,
                    "max": true,
                    "min": true,
                    "rightSide": false,
                    "show": true,
                    "total": false,
                    "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "links": [],
                  "minSpan": 12,
                  "nullPointMode": "null",
                  "percentage": false,
                  "pointradius": 5,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                    {
                      "expr": "deriv(haproxy_server_http_responses_total{backend=~\"$backend\",server=~\"$server\",code=~\"$code\",instance=~\"$host:$port\"}[5m])",
                      "interval": "$interval",
                      "intervalFactor": 1,
                      "legendFormat": "{{ backend }} {{ server }} {{ code }}",
                      "metric": "",
                      "refId": "A",
                      "step": 30
                    }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Server - Total of HTTP responses",
                  "tooltip": {
                    "msResolution": true,
                    "shared": true,
                    "sort": 2,
                    "value_type": "individual"
                  },
                  "transparent": false,
                  "type": "graph",
                  "xaxis": {
                    "mode": "time",
                    "name": null,
                    "show": true,
                    "values": []
                  },
                  "yaxes": [
                    {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": 0,
                      "show": true
                    },
                    {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": 0,
                      "show": false
                    }
                  ]
                }
              ],
              "repeat": null,
              "title": "By Server Responses by HTTP code",
              "type": "row"
            },
            {
              "collapsed": false,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 100
              },
              "id": 95,
              "panels": [],
              "repeat": null,
              "title": "By Server Sessions",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 9,
                "w": 12,
                "x": 0,
                "y": 101
              },
              "id": 61,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 12,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "haproxy_server_current_sessions{route=~\"$route\",instance=~\"$host:$port\"}",
                  "format": "time_series",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "{{ backend }} / {{ server }}",
                  "metric": "haproxy_backend_current_queue",
                  "refId": "A",
                  "step": 30
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Server - Current number of active sessions",
              "tooltip": {
                "msResolution": true,
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "description": "",
              "editable": true,
              "error": false,
              "fill": 2,
              "grid": {},
              "gridPos": {
                "h": 9,
                "w": 12,
                "x": 12,
                "y": 101
              },
              "id": 60,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "minSpan": 12,
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "haproxy_server_current_session_rate{route=~\"$route\",instance=~\"$host:$port\"}",
                  "format": "time_series",
                  "interval": "$interval",
                  "intervalFactor": 1,
                  "legendFormat": "{{ backend }} / {{ server }}",
                  "metric": "haproxy_backend_current_queue",
                  "refId": "A",
                  "step": 30
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Server - Current number of sessions rate per second over last elapsed second",
              "tooltip": {
                "msResolution": true,
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": 0,
                  "show": false
                }
              ]
            }
          ],
          "refresh": "5m",
          "schemaVersion": 16,
          "style": "dark",
          "tags": [
            "haproxy",
            "servers"
          ],
          "templating": {
            "list": [
              {
                "allValue": null,
                "current": {
                  "text": "router.default.svc.cluster.local",
                  "value": "router.default.svc.cluster.local"
                },
                "datasource": "prometheus",
                "hide": 0,
                "includeAll": false,
                "label": "Host",
                "multi": false,
                "name": "host",
                "options": [],
                "query": "label_values(haproxy_up, instance)",
                "refresh": 1,
                "regex": "/([^:]+):.*/",
                "sort": 1,
                "tagValuesQuery": null,
                "tags": [],
                "tagsQuery": null,
                "type": "query",
                "useTags": false
              },
              {
                "allValue": null,
                "current": {
                  "text": "1936",
                  "value": "1936"
                },
                "datasource": "prometheus",
                "hide": 2,
                "includeAll": false,
                "label": null,
                "multi": false,
                "name": "port",
                "options": [],
                "query": "label_values(haproxy_up, instance)",
                "refresh": 1,
                "regex": "/[^:]+:(.*)/",
                "sort": 0,
                "tagValuesQuery": "",
                "tags": [],
                "tagsQuery": "",
                "type": "query",
                "useTags": false
              },
              {
                "allValue": null,
                "current": {
                  "text": "All",
                  "value": "$__all"
                },
                "datasource": "prometheus",
                "hide": 0,
                "includeAll": true,
                "label": "Route",
                "multi": true,
                "name": "route",
                "options": [],
                "query": "label_values(haproxy_backend_up{instance=~\"$host:$port\"}, route)",
                "refresh": 1,
                "regex": "",
                "sort": 1,
                "tagValuesQuery": null,
                "tags": [],
                "tagsQuery": null,
                "type": "query",
                "useTags": false
              },
              {
                "allValue": null,
                "current": {
                  "text": "All",
                  "value": "$__all"
                },
                "datasource": "prometheus",
                "hide": 0,
                "includeAll": true,
                "label": "Frontend",
                "multi": true,
                "name": "frontend",
                "options": [],
                "query": "label_values(haproxy_frontend_bytes_in_total{instance=~\"$host:$port\"}, frontend)",
                "refresh": 1,
                "regex": "",
                "sort": 1,
                "tagValuesQuery": null,
                "tags": [],
                "tagsQuery": null,
                "type": "query",
                "useTags": true
              },
              {
                "allValue": null,
                "current": {
                  "text": "All",
                  "value": "$__all"
                },
                "datasource": "prometheus",
                "hide": 0,
                "includeAll": true,
                "label": "Server",
                "multi": true,
                "name": "server",
                "options": [],
                "query": "label_values(haproxy_server_bytes_in_total{instance=~\"$host:$port\", route=~\"$route\"}, server)",
                "refresh": 1,
                "regex": "",
                "sort": 1,
                "tagValuesQuery": null,
                "tags": [],
                "tagsQuery": null,
                "type": "query",
                "useTags": false
              },
              {
                "allValue": null,
                "current": {
                  "text": "All",
                  "value": "$__all"
                },
                "datasource": "prometheus",
                "hide": 0,
                "includeAll": true,
                "label": "HTTP Code",
                "multi": true,
                "name": "code",
                "options": [],
                "query": "label_values(haproxy_server_http_responses_total{instance=~\"$host:$port\", route=~\"$route\", server=~\"$server\"}, code)",
                "refresh": 1,
                "regex": "",
                "sort": 1,
                "tagValuesQuery": null,
                "tags": [],
                "tagsQuery": null,
                "type": "query",
                "useTags": false
              },
              {
                "auto": true,
                "auto_count": 30,
                "auto_min": "10s",
                "current": {
                  "text": "30s",
                  "value": "30s"
                },
                "hide": 0,
                "label": "Interval",
                "name": "interval",
                "options": [
                  {
                    "selected": false,
                    "text": "auto",
                    "value": "$__auto_interval_interval"
                  },
                  {
                    "selected": true,
                    "text": "30s",
                    "value": "30s"
                  },
                  {
                    "selected": false,
                    "text": "1m",
                    "value": "1m"
                  },
                  {
                    "selected": false,
                    "text": "5m",
                    "value": "5m"
                  },
                  {
                    "selected": false,
                    "text": "1h",
                    "value": "1h"
                  },
                  {
                    "selected": false,
                    "text": "6h",
                    "value": "6h"
                  },
                  {
                    "selected": false,
                    "text": "1d",
                    "value": "1d"
                  }
                ],
                "query": "30s,1m,5m,1h,6h,1d",
                "refresh": 2,
                "type": "interval"
              }
            ]
          },
          "time": {
            "from": "now-3h",
            "to": "now"
          },
          "timepicker": {
            "refresh_intervals": [
              "5s",
              "10s",
              "30s",
              "1m",
              "5m",
              "15m",
              "30m",
              "1h",
              "2h",
              "1d"
            ],
            "time_options": [
              "5m",
              "15m",
              "1h",
              "6h",
              "12h",
              "24h",
              "2d",
              "7d",
              "30d"
            ]
          },
          "timezone": "browser",
          "title": "HAProxy",
          "uid": "nStT2C3zk",
          "version": 1
        },
          "overwrite": false
        }
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: grafana-dsh-cluster-resources
  data:
    cluster-resources.json: |-
      {
        "dashboard": {
        "description": "Monitors Kubernetes cluster using Prometheus. Shows overall cluster CPU / Memory / Filesystem usage as well as individual pod, containers, systemd services statistics. Uses cAdvisor metrics only.",
        "editable": true,
        "links": [],
        "panels": [
          {
            "collapsed": false,
            "gridPos": {
              "h": 1,
              "w": 24,
              "x": 0,
              "y": 0
            },
            "id": 33,
            "panels": [],
            "repeat": null,
            "title": "Network I/O pressure",
            "type": "row"
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 5,
              "w": 24,
              "x": 0,
              "y": 1
            },
            "height": "200px",
            "id": 32,
            "legend": {
              "alignAsTable": false,
              "avg": true,
              "current": true,
              "max": false,
              "min": false,
              "rightSide": false,
              "show": false,
              "sideWidth": 200,
              "sort": "current",
              "sortDesc": true,
              "total": false,
              "values": true
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "sum (rate (container_network_receive_bytes_total{kubernetes_io_hostname=~\"^$Node$\"}[1m]))",
                "interval": "10s",
                "intervalFactor": 1,
                "legendFormat": "Received",
                "metric": "network",
                "refId": "A",
                "step": 10
              },
              {
                "expr": "- sum (rate (container_network_transmit_bytes_total{kubernetes_io_hostname=~\"^$Node$\"}[1m]))",
                "interval": "10s",
                "intervalFactor": 1,
                "legendFormat": "Sent",
                "metric": "network",
                "refId": "B",
                "step": 10
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "Network I/O pressure",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "transparent": false,
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "Bps",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "Bps",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": false
              }
            ]
          },
          {
            "collapsed": false,
            "gridPos": {
              "h": 1,
              "w": 24,
              "x": 0,
              "y": 6
            },
            "id": 34,
            "panels": [],
            "repeat": null,
            "title": "Total usage",
            "type": "row"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": true,
            "colors": [
              "rgba(50, 172, 45, 0.97)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(245, 54, 54, 0.9)"
            ],
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "format": "percent",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": true,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 5,
              "w": 8,
              "x": 0,
              "y": 7
            },
            "height": "180px",
            "id": 4,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "sum (container_memory_working_set_bytes{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"}) / sum (machine_memory_bytes{kubernetes_io_hostname=~\"^$Node$\"}) * 100",
                "interval": "10s",
                "intervalFactor": 1,
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": "65, 90",
            "title": "Cluster memory usage",
            "transparent": false,
            "type": "singlestat",
            "valueFontSize": "80%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "current"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": true,
            "colors": [
              "rgba(50, 172, 45, 0.97)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(245, 54, 54, 0.9)"
            ],
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "format": "percent",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": true,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 5,
              "w": 8,
              "x": 8,
              "y": 7
            },
            "height": "180px",
            "id": 6,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "sum (rate (container_cpu_usage_seconds_total{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) / sum (machine_cpu_cores{kubernetes_io_hostname=~\"^$Node$\"}) * 100",
                "interval": "10s",
                "intervalFactor": 1,
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": "65, 90",
            "title": "Cluster CPU usage (1m avg)",
            "type": "singlestat",
            "valueFontSize": "80%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "current"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": true,
            "colors": [
              "rgba(50, 172, 45, 0.97)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(245, 54, 54, 0.9)"
            ],
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "format": "percent",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": true,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 5,
              "w": 8,
              "x": 16,
              "y": 7
            },
            "height": "180px",
            "id": 7,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "(sum(node_filesystem_size{device=\"rootfs\"}) - sum(node_filesystem_free{device=\"rootfs\"}) ) / sum(node_filesystem_size{device=\"rootfs\"}) * 100",
                "interval": "10s",
                "intervalFactor": 1,
                "legendFormat": "",
                "metric": "",
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": "65, 90",
            "title": "Cluster filesystem usage",
            "type": "singlestat",
            "valueFontSize": "80%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "current"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(50, 172, 45, 0.97)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(245, 54, 54, 0.9)"
            ],
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "format": "bytes",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 0,
              "y": 12
            },
            "height": "1px",
            "id": 9,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "20%",
            "prefix": "",
            "prefixFontSize": "20%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "sum (container_memory_working_set_bytes{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"})",
                "interval": "10s",
                "intervalFactor": 1,
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": "",
            "title": "Used",
            "type": "singlestat",
            "valueFontSize": "50%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "current"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(50, 172, 45, 0.97)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(245, 54, 54, 0.9)"
            ],
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "format": "bytes",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 4,
              "y": 12
            },
            "height": "1px",
            "id": 10,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "sum (machine_memory_bytes{kubernetes_io_hostname=~\"^$Node$\"})",
                "interval": "10s",
                "intervalFactor": 1,
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": "",
            "title": "Total",
            "type": "singlestat",
            "valueFontSize": "50%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "current"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(50, 172, 45, 0.97)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(245, 54, 54, 0.9)"
            ],
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "format": "none",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 8,
              "y": 12
            },
            "height": "1px",
            "id": 11,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": " cores",
            "postfixFontSize": "30%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "sum (rate (container_cpu_usage_seconds_total{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))",
                "interval": "10s",
                "intervalFactor": 1,
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": "",
            "title": "Used",
            "type": "singlestat",
            "valueFontSize": "50%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "current"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(50, 172, 45, 0.97)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(245, 54, 54, 0.9)"
            ],
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "format": "none",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 12,
              "y": 12
            },
            "height": "1px",
            "id": 12,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": " cores",
            "postfixFontSize": "30%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "sum (machine_cpu_cores{kubernetes_io_hostname=~\"^$Node$\"})",
                "interval": "10s",
                "intervalFactor": 1,
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": "",
            "title": "Total",
            "type": "singlestat",
            "valueFontSize": "50%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "current"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(50, 172, 45, 0.97)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(245, 54, 54, 0.9)"
            ],
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "format": "bytes",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 16,
              "y": 12
            },
            "height": "1px",
            "id": 13,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "(sum(node_filesystem_size{device=\"rootfs\"}) - sum(node_filesystem_free{device=\"rootfs\"}) ) ",
                "interval": "10s",
                "intervalFactor": 1,
                "legendFormat": "",
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": "",
            "title": "Used",
            "type": "singlestat",
            "valueFontSize": "50%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "current"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(50, 172, 45, 0.97)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(245, 54, 54, 0.9)"
            ],
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "format": "bytes",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 20,
              "y": 12
            },
            "height": "1px",
            "id": 14,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "node_filesystem_size{device=\"rootfs\"}",
                "interval": "10s",
                "intervalFactor": 1,
                "legendFormat": "",
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": "",
            "title": "Total",
            "type": "singlestat",
            "valueFontSize": "50%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "current"
          },
          {
            "collapsed": false,
            "gridPos": {
              "h": 1,
              "w": 24,
              "x": 0,
              "y": 15
            },
            "id": 35,
            "panels": [],
            "repeat": null,
            "title": "Pods CPU usage",
            "type": "row"
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "decimals": 3,
            "editable": true,
            "error": false,
            "fill": 0,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 24,
              "x": 0,
              "y": 16
            },
            "height": "",
            "id": 17,
            "legend": {
              "alignAsTable": true,
              "avg": true,
              "current": true,
              "max": false,
              "min": false,
              "rightSide": true,
              "show": true,
              "sort": "current",
              "sortDesc": true,
              "total": false,
              "values": true
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": true,
            "targets": [
              {
                "expr": "sum (rate (container_cpu_usage_seconds_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (pod_name)",
                "interval": "10s",
                "intervalFactor": 1,
                "legendFormat": "{{ pod_name }}",
                "metric": "container_cpu",
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "Pods CPU usage (1m avg)",
            "tooltip": {
              "msResolution": true,
              "shared": true,
              "sort": 2,
              "value_type": "cumulative"
            },
            "transparent": false,
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "none",
                "label": "cores",
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": false
              }
            ]
          },
          {
            "collapsed": true,
            "gridPos": {
              "h": 1,
              "w": 24,
              "x": 0,
              "y": 23
            },
            "id": 36,
            "panels": [
              {
                "aliasColors": {},
                "bars": false,
                "datasource": "prometheus",
                "decimals": 3,
                "editable": true,
                "error": false,
                "fill": 0,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 23
                },
                "height": "",
                "id": 24,
                "legend": {
                  "alignAsTable": true,
                  "avg": true,
                  "current": true,
                  "hideEmpty": false,
                  "hideZero": false,
                  "max": false,
                  "min": false,
                  "rightSide": true,
                  "show": true,
                  "sideWidth": null,
                  "sort": "current",
                  "sortDesc": true,
                  "total": false,
                  "values": true
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [],
                "stack": false,
                "steppedLine": true,
                "targets": [
                  {
                    "expr": "sum (rate (container_cpu_usage_seconds_total{image!=\"\",name=~\"^k8s_.*\",container_name!=\"POD\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (container_name, pod_name)",
                    "hide": false,
                    "interval": "10s",
                    "intervalFactor": 1,
                    "legendFormat": "pod: {{ pod_name }} | {{ container_name }}",
                    "metric": "container_cpu",
                    "refId": "A",
                    "step": 10
                  },
                  {
                    "expr": "sum (rate (container_cpu_usage_seconds_total{image!=\"\",name!~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (kubernetes_io_hostname, name, image)",
                    "hide": false,
                    "interval": "10s",
                    "intervalFactor": 1,
                    "legendFormat": "docker: {{ kubernetes_io_hostname }} | {{ image }} ({{ name }})",
                    "metric": "container_cpu",
                    "refId": "B",
                    "step": 10
                  },
                  {
                    "expr": "sum (rate (container_cpu_usage_seconds_total{rkt_container_name!=\"\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (kubernetes_io_hostname, rkt_container_name)",
                    "interval": "10s",
                    "intervalFactor": 1,
                    "legendFormat": "rkt: {{ kubernetes_io_hostname }} | {{ rkt_container_name }}",
                    "metric": "container_cpu",
                    "refId": "C",
                    "step": 10
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Containers CPU usage (1m avg)",
                "tooltip": {
                  "msResolution": true,
                  "shared": true,
                  "sort": 2,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "none",
                    "label": "cores",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "label": null,
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": false
                  }
                ]
              }
            ],
            "repeat": null,
            "title": "Containers CPU usage",
            "type": "row"
          },
          {
            "collapsed": false,
            "gridPos": {
              "h": 1,
              "w": 24,
              "x": 0,
              "y": 24
            },
            "id": 37,
            "panels": [],
            "repeat": null,
            "title": "Pods memory usage",
            "type": "row"
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "fill": 0,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 24,
              "x": 0,
              "y": 25
            },
            "id": 25,
            "legend": {
              "alignAsTable": true,
              "avg": true,
              "current": true,
              "max": false,
              "min": false,
              "rightSide": true,
              "show": true,
              "sideWidth": 200,
              "sort": "current",
              "sortDesc": true,
              "total": false,
              "values": true
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": true,
            "targets": [
              {
                "expr": "sum (container_memory_working_set_bytes{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}) by (pod_name)",
                "interval": "10s",
                "intervalFactor": 1,
                "legendFormat": "{{ pod_name }}",
                "metric": "container_memory_usage:sort_desc",
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "Pods memory usage",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 2,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "bytes",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": false
              }
            ]
          },
          {
            "collapsed": true,
            "gridPos": {
              "h": 1,
              "w": 24,
              "x": 0,
              "y": 32
            },
            "id": 38,
            "panels": [
              {
                "aliasColors": {},
                "bars": false,
                "datasource": "prometheus",
                "decimals": 2,
                "editable": true,
                "error": false,
                "fill": 0,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 32
                },
                "id": 27,
                "legend": {
                  "alignAsTable": true,
                  "avg": true,
                  "current": true,
                  "max": false,
                  "min": false,
                  "rightSide": true,
                  "show": true,
                  "sideWidth": 200,
                  "sort": "current",
                  "sortDesc": true,
                  "total": false,
                  "values": true
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [],
                "stack": false,
                "steppedLine": true,
                "targets": [
                  {
                    "expr": "sum (container_memory_working_set_bytes{image!=\"\",name=~\"^k8s_.*\",container_name!=\"POD\",kubernetes_io_hostname=~\"^$Node$\"}) by (container_name, pod_name)",
                    "interval": "10s",
                    "intervalFactor": 1,
                    "legendFormat": "pod: {{ pod_name }} | {{ container_name }}",
                    "metric": "container_memory_usage:sort_desc",
                    "refId": "A",
                    "step": 10
                  },
                  {
                    "expr": "sum (container_memory_working_set_bytes{image!=\"\",name!~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname, name, image)",
                    "interval": "10s",
                    "intervalFactor": 1,
                    "legendFormat": "docker: {{ kubernetes_io_hostname }} | {{ image }} ({{ name }})",
                    "metric": "container_memory_usage:sort_desc",
                    "refId": "B",
                    "step": 10
                  },
                  {
                    "expr": "sum (container_memory_working_set_bytes{rkt_container_name!=\"\",kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname, rkt_container_name)",
                    "interval": "10s",
                    "intervalFactor": 1,
                    "legendFormat": "rkt: {{ kubernetes_io_hostname }} | {{ rkt_container_name }}",
                    "metric": "container_memory_usage:sort_desc",
                    "refId": "C",
                    "step": 10
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Containers memory usage",
                "tooltip": {
                  "msResolution": false,
                  "shared": true,
                  "sort": 2,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "bytes",
                    "label": null,
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "label": null,
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": false
                  }
                ]
              }
            ],
            "repeat": null,
            "title": "Containers memory usage",
            "type": "row"
          },
          {
            "collapsed": false,
            "gridPos": {
              "h": 1,
              "w": 24,
              "x": 0,
              "y": 33
            },
            "id": 39,
            "panels": [],
            "repeat": null,
            "title": "All processes memory usage",
            "type": "row"
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "fill": 0,
            "grid": {},
            "gridPos": {
              "h": 13,
              "w": 24,
              "x": 0,
              "y": 34
            },
            "id": 28,
            "legend": {
              "alignAsTable": true,
              "avg": true,
              "current": true,
              "max": false,
              "min": false,
              "rightSide": false,
              "show": true,
              "sideWidth": 200,
              "sort": "current",
              "sortDesc": true,
              "total": false,
              "values": true
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": true,
            "targets": [
              {
                "expr": "sum (container_memory_working_set_bytes{id!=\"/\",kubernetes_io_hostname=~\"^$Node$\"}) by (id)",
                "interval": "10s",
                "intervalFactor": 1,
                "legendFormat": "{{ id }}",
                "metric": "container_memory_usage:sort_desc",
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "All processes memory usage",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 2,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "bytes",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": false
              }
            ]
          },
          {
            "collapsed": false,
            "gridPos": {
              "h": 1,
              "w": 24,
              "x": 0,
              "y": 47
            },
            "id": 40,
            "panels": [],
            "repeat": null,
            "title": "Pods network I/O",
            "type": "row"
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 24,
              "x": 0,
              "y": 48
            },
            "id": 16,
            "legend": {
              "alignAsTable": true,
              "avg": true,
              "current": true,
              "max": false,
              "min": false,
              "rightSide": true,
              "show": true,
              "sideWidth": 200,
              "sort": "current",
              "sortDesc": true,
              "total": false,
              "values": true
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "sum (rate (container_network_receive_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (pod_name)",
                "interval": "10s",
                "intervalFactor": 1,
                "legendFormat": "-> {{ pod_name }}",
                "metric": "network",
                "refId": "A",
                "step": 10
              },
              {
                "expr": "- sum (rate (container_network_transmit_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (pod_name)",
                "interval": "10s",
                "intervalFactor": 1,
                "legendFormat": "<- {{ pod_name }}",
                "metric": "network",
                "refId": "B",
                "step": 10
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "Pods network I/O (1m avg)",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 2,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "Bps",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": false
              }
            ]
          }
        ],
        "refresh": "10s",
        "schemaVersion": 16,
        "style": "dark",
        "tags": [
          "openshift",
          "cluster"
        ],
        "templating": {
          "list": [
            {
              "allValue": ".*",
              "current": {
                "text": "All",
                "value": "$__all"
              },
              "datasource": "prometheus",
              "hide": 0,
              "includeAll": true,
              "label": null,
              "multi": false,
              "name": "Node",
              "options": [],
              "query": "label_values(kubernetes_io_hostname)",
              "refresh": 1,
              "regex": "",
              "sort": 0,
              "tagValuesQuery": "",
              "tags": [],
              "tagsQuery": "",
              "type": "query",
              "useTags": false
            }
          ]
        },
        "time": {
          "from": "now-3h",
          "to": "now"
        },
        "timepicker": {
          "refresh_intervals": [
            "5s",
            "10s",
            "30s",
            "1m",
            "5m",
            "15m",
            "30m",
            "1h",
            "2h",
            "1d"
          ],
          "time_options": [
            "5m",
            "15m",
            "1h",
            "6h",
            "12h",
            "24h",
            "2d",
            "7d",
            "30d"
          ]
        },
        "timezone": "browser",
        "title": "OpenShift Cluster Resources",
        "uid": "fKjh2C3zk",
        "version": 2
      },
        "overwrite": false
      }
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: grafana-dsh-go-metrics
  data:
    go-metrics.json: |-
      {
        "dashboard": {
        "description": "Process status published by Go Prometheus client library, e.g. memory used, fds open, GC details",
        "editable": true,
        "links": [],
        "panels": [
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 12,
              "x": 0,
              "y": 0
            },
            "id": 1,
            "isNew": true,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [
              {
                "alias": "resident",
                "yaxis": 2
              }
            ],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "process_resident_memory_bytes{job=\"$job\"}",
                "intervalFactor": 2,
                "legendFormat": "resident",
                "metric": "process_resident_memory_bytes",
                "refId": "A",
                "step": 4
              },
              {
                "expr": "process_virtual_memory_bytes{job=\"$job\"}",
                "intervalFactor": 2,
                "legendFormat": "virtual",
                "metric": "process_virtual_memory_bytes",
                "refId": "B",
                "step": 4
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "process memory",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "bytes",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 12,
              "x": 12,
              "y": 0
            },
            "id": 4,
            "isNew": true,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [
              {
                "alias": "resident",
                "yaxis": 1
              }
            ],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "rate(process_resident_memory_bytes{job=\"$job\"}[$interval])",
                "intervalFactor": 2,
                "legendFormat": "resident",
                "metric": "process_resident_memory_bytes",
                "refId": "A",
                "step": 4
              },
              {
                "expr": "deriv(process_virtual_memory_bytes{job=\"$job\"}[$interval])",
                "intervalFactor": 2,
                "legendFormat": "virtual",
                "metric": "process_virtual_memory_bytes",
                "refId": "B",
                "step": 4
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "process memory deriv",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "bytes",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 12,
              "x": 0,
              "y": 7
            },
            "id": 2,
            "isNew": true,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [
              {
                "alias": "alloc rate",
                "yaxis": 2
              }
            ],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "go_memstats_alloc_bytes{job=\"$job\"}",
                "intervalFactor": 2,
                "legendFormat": "bytes allocated",
                "metric": "go_memstats_alloc_bytes",
                "refId": "A",
                "step": 4
              },
              {
                "expr": "rate(go_memstats_alloc_bytes_total{job=\"$job\"}[30s])",
                "intervalFactor": 2,
                "legendFormat": "alloc rate",
                "metric": "go_memstats_alloc_bytes_total",
                "refId": "B",
                "step": 4
              },
              {
                "expr": "go_memstats_stack_inuse_bytes{job=\"$job\"}",
                "intervalFactor": 2,
                "legendFormat": "stack inuse",
                "metric": "go_memstats_stack_inuse_bytes",
                "refId": "C",
                "step": 4
              },
              {
                "expr": "go_memstats_heap_inuse_bytes{job=\"$job\"}",
                "hide": false,
                "intervalFactor": 2,
                "legendFormat": "heap inuse",
                "metric": "go_memstats_heap_inuse_bytes",
                "refId": "D",
                "step": 4
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "go memstats",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "bytes",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "Bps",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 12,
              "x": 12,
              "y": 7
            },
            "id": 5,
            "isNew": true,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [
              {
                "alias": "alloc rate",
                "yaxis": 2
              }
            ],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "deriv(go_memstats_alloc_bytes{job=\"$job\"}[$interval])",
                "intervalFactor": 2,
                "legendFormat": "bytes allocated",
                "metric": "go_memstats_alloc_bytes",
                "refId": "A",
                "step": 4
              },
              {
                "expr": "rate(go_memstats_alloc_bytes_total{job=\"$job\"}[$interval])",
                "intervalFactor": 2,
                "legendFormat": "alloc rate",
                "metric": "go_memstats_alloc_bytes_total",
                "refId": "B",
                "step": 4
              },
              {
                "expr": "deriv(go_memstats_stack_inuse_bytes{job=\"$job\"}[$interval])",
                "intervalFactor": 2,
                "legendFormat": "stack inuse",
                "metric": "go_memstats_stack_inuse_bytes",
                "refId": "C",
                "step": 4
              },
              {
                "expr": "deriv(go_memstats_heap_inuse_bytes{job=\"$job\"}[$interval])",
                "hide": false,
                "intervalFactor": 2,
                "legendFormat": "heap inuse",
                "metric": "go_memstats_heap_inuse_bytes",
                "refId": "D",
                "step": 4
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "go memstats deriv",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "bytes",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "Bps",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 12,
              "x": 0,
              "y": 14
            },
            "id": 3,
            "isNew": true,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "process_open_fds{job=\"$job\"}",
                "intervalFactor": 2,
                "legendFormat": "{{job}}",
                "metric": "process_open_fds",
                "refId": "A",
                "step": 4
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "open fds",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 12,
              "x": 12,
              "y": 14
            },
            "id": 6,
            "isNew": true,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "deriv(process_open_fds{job=\"$job\"}[$interval])",
                "intervalFactor": 2,
                "metric": "process_open_fds",
                "refId": "A",
                "step": 4
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "open fds deriv",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 12,
              "x": 0,
              "y": 21
            },
            "id": 7,
            "isNew": true,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "go_goroutines{job=\"$job\"}",
                "intervalFactor": 2,
                "legendFormat": "{{job}}",
                "metric": "go_goroutines",
                "refId": "A",
                "step": 4
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "Goroutines",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 12,
              "x": 12,
              "y": 21
            },
            "id": 8,
            "isNew": true,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "go_gc_duration_seconds{job=\"$job\"}",
                "intervalFactor": 2,
                "legendFormat": "{{quantile}}",
                "metric": "go_gc_duration_seconds",
                "refId": "A",
                "step": 4
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "GC duration quantiles",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "s",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          }
        ],
        "refresh": "30s",
        "schemaVersion": 16,
        "style": "dark",
        "tags": [
          "Go"
        ],
        "templating": {
          "list": [
            {
              "allValue": null,
              "current": {
                "text": "kubernetes-service-endpoints",
                "value": "kubernetes-service-endpoints"
              },
              "datasource": "prometheus",
              "hide": 0,
              "includeAll": false,
              "label": null,
              "multi": false,
              "name": "job",
              "options": [],
              "query": "label_values(go_memstats_alloc_bytes,job)",
              "refresh": 1,
              "regex": "",
              "sort": 0,
              "tagValuesQuery": "",
              "tags": [],
              "tagsQuery": "",
              "type": "query",
              "useTags": false
            },
            {
              "auto": false,
              "auto_count": 30,
              "auto_min": "10s",
              "current": {
                "text": "10m",
                "value": "10m"
              },
              "datasource": null,
              "hide": 0,
              "includeAll": false,
              "label": "",
              "multi": false,
              "name": "interval",
              "options": [
                {
                  "selected": false,
                  "text": "1m",
                  "value": "1m"
                },
                {
                  "selected": false,
                  "text": "5m",
                  "value": "5m"
                },
                {
                  "selected": true,
                  "text": "10m",
                  "value": "10m"
                },
                {
                  "selected": false,
                  "text": "30m",
                  "value": "30m"
                },
                {
                  "selected": false,
                  "text": "1h",
                  "value": "1h"
                }
              ],
              "query": "1m,5m,10m,30m,1h",
              "refresh": 2,
              "type": "interval"
            }
          ]
        },
        "time": {
          "from": "now-3h",
          "to": "now"
        },
        "timepicker": {
          "refresh_intervals": [
            "5s",
            "10s",
            "30s",
            "1m",
            "5m",
            "15m",
            "30m",
            "1h",
            "2h",
            "1d"
          ],
          "time_options": [
            "5m",
            "15m",
            "1h",
            "6h",
            "12h",
            "24h",
            "2d",
            "7d",
            "30d"
          ]
        },
        "timezone": "browser",
        "title": "Go Processes",
        "uid": "6-TdEA6kz",
        "version": 2
      },
        "overwrite": false
      }
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: grafana-dsh-infra-overview
  data:
    infra-overview.json: |-
      {
        "dashboard": {
            "description": "Dashboard to view multiple servers",
            "editable": true,
            "links": [],
            "panels": [
              {
                "content": "",
                "editable": true,
                "error": false,
                "gridPos": {
                  "h": 3,
                  "w": 24,
                  "x": 0,
                  "y": 0
                },
                "id": 11,
                "minSpan": 4,
                "mode": "html",
                "repeat": "node",
                "style": {},
                "title": "$node",
                "type": "text"
              },
              {
                "cacheTimeout": null,
                "colorBackground": false,
                "colorValue": false,
                "colors": [
                  "rgba(245, 54, 54, 0.9)",
                  "rgba(237, 129, 40, 0.89)",
                  "rgba(50, 172, 45, 0.97)"
                ],
                "datasource": "prometheus",
                "editable": true,
                "error": false,
                "format": "none",
                "gauge": {
                  "maxValue": 100,
                  "minValue": 0,
                  "show": false,
                  "thresholdLabels": false,
                  "thresholdMarkers": true
                },
                "gridPos": {
                  "h": 3,
                  "w": 24,
                  "x": 0,
                  "y": 3
                },
                "id": 20,
                "interval": null,
                "links": [],
                "mappingType": 1,
                "mappingTypes": [
                  {
                    "name": "value to text",
                    "value": 1
                  },
                  {
                    "name": "range to text",
                    "value": 2
                  }
                ],
                "maxDataPoints": 100,
                "minSpan": 4,
                "nullPointMode": "connected",
                "nullText": null,
                "postfix": "",
                "postfixFontSize": "50%",
                "prefix": "",
                "prefixFontSize": "50%",
                "rangeMaps": [
                  {
                    "from": "null",
                    "text": "N/A",
                    "to": "null"
                  }
                ],
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "sparkline": {
                  "fillColor": "rgba(31, 118, 189, 0.18)",
                  "full": false,
                  "lineColor": "rgb(31, 120, 193)",
                  "show": false
                },
                "tableColumn": "",
                "targets": [
                  {
                    "expr": "count(node_cpu{instance=~\"$node\", mode=\"system\"})",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "",
                    "metric": "",
                    "refId": "A",
                    "step": 14400,
                    "target": ""
                  }
                ],
                "thresholds": "",
                "title": "CPU Cores",
                "type": "singlestat",
                "valueFontSize": "80%",
                "valueMaps": [
                  {
                    "op": "=",
                    "text": "N/A",
                    "value": "null"
                  }
                ],
                "valueName": "avg"
              },
              {
                "aliasColors": {},
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "decimals": 3,
                "editable": true,
                "error": false,
                "fill": 10,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 6
                },
                "id": 7,
                "legend": {
                  "alignAsTable": false,
                  "avg": false,
                  "current": false,
                  "hideEmpty": false,
                  "max": false,
                  "min": false,
                  "rightSide": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 0,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": true,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [],
                "spaceLength": 10,
                "stack": true,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "sum by (mode)(irate(node_cpu{mode=\"system\",instance=~'$node'}[5m]))",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "{{mode}}",
                    "metric": "",
                    "refId": "A",
                    "step": 1200,
                    "target": ""
                  },
                  {
                    "expr": "sum by (mode)(irate(node_cpu{mode='user',instance=~'$node'}[5m]))",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "user",
                    "refId": "B",
                    "step": 1200
                  },
                  {
                    "expr": "sum by (mode)(irate(node_cpu{mode='nice',instance=~'$node'}[5m]))",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "nice",
                    "refId": "C",
                    "step": 1200
                  },
                  {
                    "expr": "sum by (mode)(irate(node_cpu{mode='iowait',instance=~'$node'}[5m]))",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "iowait",
                    "refId": "E",
                    "step": 1200
                  },
                  {
                    "expr": "sum by (mode)(irate(node_cpu{mode='steal',instance=~'$node'}[5m]))",
                    "intervalFactor": 2,
                    "legendFormat": "steal",
                    "refId": "H",
                    "step": 1200
                  },
                  {
                    "expr": "sum by (mode)(irate(node_cpu{mode='idle',instance=~'$node'}[5m]))",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "idle",
                    "refId": "D",
                    "step": 1200
                  },
                  {
                    "expr": "sum by (mode)(irate(node_cpu{mode='irq',instance=~'$node'}[5m]))",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "irq",
                    "refId": "F",
                    "step": 1200
                  },
                  {
                    "expr": "sum by (mode)(irate(node_cpu{mode='softirq',instance=~'$node'}[5m]))",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "softirq",
                    "refId": "G",
                    "step": 1200
                  },
                  {
                    "expr": "sum by (mode)(irate(node_cpu{mode='guest',instance=~'$node'}[5m]))",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "guest",
                    "refId": "I",
                    "step": 1200
                  }
                ],
                "thresholds": [
                  {
                    "colorMode": "custom",
                    "fill": true,
                    "fillColor": "rgba(216, 200, 27, 0.27)",
                    "op": "gt",
                    "value": 0
                  }
                ],
                "timeFrom": null,
                "timeShift": null,
                "title": "CPU",
                "tooltip": {
                  "msResolution": false,
                  "shared": true,
                  "sort": 0,
                  "value_type": "individual"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "short",
                    "label": "%",
                    "logBase": 1,
                    "max": 100,
                    "min": 0,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              },
              {
                "aliasColors": {
                  "Slab": "#E5A8E2",
                  "Swap": "#E24D42"
                },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "decimals": 2,
                "editable": true,
                "error": false,
                "fill": 1,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 13
                },
                "id": 17,
                "legend": {
                  "avg": false,
                  "current": false,
                  "max": false,
                  "min": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [
                  {
                    "alias": "/Apps|Buffers|Cached|Free|Slab|SwapCached|PageTables|VmallocUsed/",
                    "fill": 5,
                    "stack": true
                  },
                  {
                    "alias": "Swap",
                    "fill": 5,
                    "stack": true
                  }
                ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "( node_memory_MemTotal{instance=~'$node'} - node_memory_MemFree{instance=~'$node'} - node_memory_Buffers{instance=~'$node'} - node_memory_Cached{instance=~'$node'} - node_memory_SwapCached{instance=~'$node'} - node_memory_Slab{instance=~'$node'} - node_memory_PageTables{instance=~'$node'} - node_memory_VmallocUsed{instance=~'$node'} )",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "Apps",
                    "metric": "",
                    "refId": "A",
                    "step": 1200,
                    "target": ""
                  },
                  {
                    "expr": "node_memory_Buffers{instance=~'$node'}",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "Buffers",
                    "refId": "B",
                    "step": 1200
                  },
                  {
                    "expr": "node_memory_Cached{instance=~'$node'}",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "Cached",
                    "refId": "D",
                    "step": 1200
                  },
                  {
                    "expr": "node_memory_MemFree{instance=~'$node'}",
                    "hide": false,
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "Free",
                    "refId": "E",
                    "step": 1200
                  },
                  {
                    "expr": "node_memory_Slab{instance=~'$node'}",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "Slab",
                    "refId": "F",
                    "step": 1200
                  },
                  {
                    "expr": "node_memory_SwapCached{instance=~'$node'}",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "SwapCached",
                    "refId": "G",
                    "step": 1200
                  },
                  {
                    "expr": "node_memory_PageTables{instance=~'$node'}",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "PageTables",
                    "refId": "H",
                    "step": 1200
                  },
                  {
                    "expr": "node_memory_VmallocUsed{instance=~'$node'}",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "VmallocUsed",
                    "metric": "",
                    "refId": "I",
                    "step": 1200
                  },
                  {
                    "expr": "(node_memory_SwapTotal{instance=~'$node'} - node_memory_SwapFree{instance=~'$node'})",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "Swap",
                    "metric": "",
                    "refId": "C",
                    "step": 1200
                  },
                  {
                    "expr": "node_memory_Committed_AS{instance=~'$node'}",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "Committed",
                    "metric": "",
                    "refId": "J",
                    "step": 1200
                  },
                  {
                    "expr": "node_memory_Mapped{instance=~'$node'}",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "Mapped",
                    "refId": "K",
                    "step": 1200
                  },
                  {
                    "expr": "node_memory_Active{instance=~'$node'}",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "Active",
                    "metric": "",
                    "refId": "L",
                    "step": 1200
                  },
                  {
                    "expr": "node_memory_Inactive{instance=~'$node'}",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "Inactive",
                    "metric": "",
                    "refId": "M",
                    "step": 1200
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Memory",
                "tooltip": {
                  "msResolution": false,
                  "shared": true,
                  "sort": 0,
                  "value_type": "individual"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "bytes",
                    "label": "GB",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              },
              {
                "aliasColors": {},
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "editable": true,
                "error": false,
                "fill": 1,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 20
                },
                "id": 13,
                "legend": {
                  "avg": false,
                  "current": false,
                  "max": false,
                  "min": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "node_load1{instance=~\"$node\"}",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "load",
                    "metric": "",
                    "refId": "A",
                    "step": 1200,
                    "target": ""
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Load",
                "tooltip": {
                  "msResolution": false,
                  "shared": true,
                  "sort": 0,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              },
              {
                "aliasColors": {},
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "decimals": 3,
                "editable": true,
                "error": false,
                "fill": 1,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 27
                },
                "id": 9,
                "legend": {
                  "avg": false,
                  "current": false,
                  "max": false,
                  "min": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "100.0 - 100 * (node_filesystem_avail{instance=~'$node',device !~'tmpfs',device!~'by-uuid'} / node_filesystem_size{instance=~'$node',device !~'tmpfs',device!~'by-uuid'})",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "{{mountpoint}}",
                    "metric": "",
                    "refId": "A",
                    "step": 1200,
                    "target": ""
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Disk Space Used",
                "tooltip": {
                  "msResolution": true,
                  "shared": true,
                  "sort": 0,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "percent",
                    "logBase": 1,
                    "max": 100,
                    "min": 0,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              },
              {
                "aliasColors": {},
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "editable": true,
                "error": false,
                "fill": 1,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 34
                },
                "id": 19,
                "legend": {
                  "avg": false,
                  "current": false,
                  "max": false,
                  "min": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "irate(node_disk_io_time_ms{instance=~\"$node\"}[5m])/10",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "{{device}}",
                    "metric": "",
                    "refId": "A",
                    "step": 1200,
                    "target": ""
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Disk Utilization per Device",
                "tooltip": {
                  "msResolution": false,
                  "shared": false,
                  "sort": 0,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "percent",
                    "logBase": 1,
                    "max": 100,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              },
              {
                "aliasColors": {},
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "editable": true,
                "error": false,
                "fill": 1,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 41
                },
                "id": 14,
                "legend": {
                  "avg": false,
                  "current": false,
                  "max": false,
                  "min": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [
                  {
                    "alias": "/.*_read$/",
                    "transform": "negative-Y"
                  }
                ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "irate(node_disk_reads_completed{instance=~'$node'}[5m])",
                    "interval": "",
                    "intervalFactor": 4,
                    "legendFormat": "{{device}}_read",
                    "metric": "",
                    "refId": "A",
                    "step": 2400,
                    "target": ""
                  },
                  {
                    "expr": "irate(node_disk_writes_completed{instance=~'$node'}[5m])",
                    "intervalFactor": 2,
                    "legendFormat": "{{device}}_write",
                    "metric": "",
                    "refId": "B",
                    "step": 1200
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Disk IOs per Device",
                "tooltip": {
                  "msResolution": false,
                  "shared": false,
                  "sort": 0,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "short",
                    "label": "IO/second read (-) / write (+)",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              },
              {
                "aliasColors": {},
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "editable": true,
                "error": false,
                "fill": 1,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 48
                },
                "id": 18,
                "legend": {
                  "avg": false,
                  "current": false,
                  "max": false,
                  "min": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [
                  {
                    "alias": "/.*_read/",
                    "transform": "negative-Y"
                  }
                ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "irate(node_disk_sectors_read{instance=~'$node'}[5m]) * 512",
                    "interval": "",
                    "intervalFactor": 4,
                    "legendFormat": "{{device}}_read",
                    "refId": "B",
                    "step": 2400
                  },
                  {
                    "expr": "irate(node_disk_sectors_written{instance=~'$node'}[5m]) * 512",
                    "interval": "",
                    "intervalFactor": 4,
                    "legendFormat": "{{device}}_write",
                    "metric": "",
                    "refId": "A",
                    "step": 2400,
                    "target": ""
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Disk Throughput per Device",
                "tooltip": {
                  "msResolution": false,
                  "shared": false,
                  "sort": 0,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "bytes",
                    "label": "Bytes/second read (-) / write (+)",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              },
              {
                "aliasColors": {},
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "editable": true,
                "error": false,
                "fill": 1,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 55
                },
                "id": 22,
                "legend": {
                  "avg": false,
                  "current": false,
                  "max": false,
                  "min": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "irate(node_context_switches{instance=~\"$node\"}[5m])",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "context switches",
                    "metric": "",
                    "refId": "A",
                    "step": 1200,
                    "target": ""
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Context Switches",
                "tooltip": {
                  "msResolution": false,
                  "shared": true,
                  "sort": 0,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              },
              {
                "aliasColors": {},
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "editable": true,
                "error": false,
                "fill": 1,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 62
                },
                "id": 12,
                "legend": {
                  "avg": false,
                  "current": false,
                  "max": false,
                  "min": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [
                  {
                    "alias": "/.*_in/",
                    "transform": "negative-Y"
                  }
                ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "irate(node_network_receive_bytes{instance=~'$node'}[5m])*8",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "{{device}}_in",
                    "metric": "",
                    "refId": "A",
                    "step": 1200,
                    "target": ""
                  },
                  {
                    "expr": "irate(node_network_transmit_bytes{instance=~'$node'}[5m])*8",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "{{device}}_out",
                    "refId": "B",
                    "step": 1200
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Network Traffic",
                "tooltip": {
                  "msResolution": false,
                  "shared": true,
                  "sort": 0,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "bits",
                    "label": "bits in (-) / bits out (+)",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              },
              {
                "aliasColors": {},
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "editable": true,
                "error": false,
                "fill": 1,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 69
                },
                "id": 21,
                "legend": {
                  "avg": false,
                  "current": false,
                  "max": false,
                  "min": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "node_netstat_Tcp_CurrEstab{instance=~'$node'}",
                    "intervalFactor": 2,
                    "legendFormat": "established",
                    "refId": "A",
                    "step": 1200,
                    "target": ""
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Netstat",
                "tooltip": {
                  "msResolution": false,
                  "shared": true,
                  "sort": 0,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              },
              {
                "aliasColors": {},
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "editable": true,
                "error": false,
                "fill": 1,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 76
                },
                "id": 23,
                "legend": {
                  "avg": false,
                  "current": false,
                  "max": false,
                  "min": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [
                  {
                    "alias": "/.*Out.*/",
                    "transform": "negative-Y"
                  },
                  {
                    "alias": "Udp_NoPorts",
                    "yaxis": 2
                  }
                ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "irate(node_netstat_Udp_InDatagrams{instance=~\"$node\"}[5m])",
                    "intervalFactor": 2,
                    "legendFormat": "Udp_InDatagrams",
                    "refId": "A",
                    "step": 1200,
                    "target": ""
                  },
                  {
                    "expr": "irate(node_netstat_Udp_InErrors{instance=~\"$node\"}[5m])",
                    "intervalFactor": 2,
                    "legendFormat": "Udp_InErrors",
                    "refId": "B",
                    "step": 1200
                  },
                  {
                    "expr": "irate(node_netstat_Udp_OutDatagrams{instance=~\"$node\"}[5m])",
                    "interval": "",
                    "intervalFactor": 2,
                    "legendFormat": "Udp_OutDatagrams",
                    "refId": "C",
                    "step": 1200
                  },
                  {
                    "expr": "irate(node_netstat_Udp_NoPorts{instance=~\"$node\"}[5m])",
                    "intervalFactor": 2,
                    "legendFormat": "Udp_NoPorts",
                    "refId": "D",
                    "step": 1200
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "UDP Stats",
                "tooltip": {
                  "msResolution": false,
                  "shared": true,
                  "sort": 0,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              },
              {
                "aliasColors": {},
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "prometheus",
                "editable": true,
                "error": false,
                "fill": 1,
                "grid": {},
                "gridPos": {
                  "h": 7,
                  "w": 24,
                  "x": 0,
                  "y": 83
                },
                "id": 24,
                "legend": {
                  "avg": false,
                  "current": false,
                  "max": false,
                  "min": false,
                  "show": true,
                  "total": false,
                  "values": false
                },
                "lines": true,
                "linewidth": 2,
                "links": [],
                "minSpan": 4,
                "nullPointMode": "connected",
                "percentage": false,
                "pointradius": 5,
                "points": false,
                "renderer": "flot",
                "repeat": "node",
                "scopedVars": {
                  "node": {
                    "selected": true,
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  }
                },
                "seriesOverrides": [],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                  {
                    "expr": "node_nf_conntrack_entries_limit{instance=~\"$node\"} - node_nf_conntrack_entries{instance=~\"$node\"}",
                    "intervalFactor": 2,
                    "legendFormat": "free",
                    "refId": "A",
                    "step": 1200,
                    "target": ""
                  }
                ],
                "thresholds": [],
                "timeFrom": null,
                "timeShift": null,
                "title": "Conntrack",
                "tooltip": {
                  "msResolution": false,
                  "shared": true,
                  "sort": 0,
                  "value_type": "cumulative"
                },
                "type": "graph",
                "xaxis": {
                  "buckets": null,
                  "mode": "time",
                  "name": null,
                  "show": true,
                  "values": []
                },
                "yaxes": [
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  },
                  {
                    "format": "short",
                    "logBase": 1,
                    "max": null,
                    "min": null,
                    "show": true
                  }
                ]
              }
            ],
            "schemaVersion": 16,
            "style": "dark",
            "tags": [
              "prometheus",
              "openshift",
              "infra"
            ],
            "templating": {
              "list": [
                {
                  "allFormat": "glob",
                  "allValue": null,
                  "current": {
                    "text": "192.168.41.10:9100",
                    "value": "192.168.41.10:9100"
                  },
                  "datasource": "prometheus",
                  "hide": 0,
                  "includeAll": false,
                  "label": "",
                  "multi": true,
                  "multiFormat": "regex values",
                  "name": "node",
                  "options": [],
                  "query": "label_values(node_boot_time, instance)",
                  "refresh": 1,
                  "regex": "",
                  "sort": 1,
                  "tagValuesQuery": "",
                  "tags": [],
                  "tagsQuery": "",
                  "type": "query",
                  "useTags": false
                }
              ]
            },
            "time": {
              "from": "now-3h",
              "to": "now"
            },
            "timepicker": {
              "now": true,
              "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
              ],
              "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
              ]
            },
            "timezone": "browser",
            "title": "OpenShift Nodes Overview",
            "uid": "CgJ8L0ekz",
            "version": 2
      },
        "overwrite": false
      }
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: grafana-dsh-node-status
  data:
    node-status.json: |-
      {
        "dashboard": {
        "description": "Dashboard to get an overview of one server",
        "links": [],
        "panels": [
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(245, 54, 54, 0.9)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(50, 172, 45, 0.97)"
            ],
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "format": "none",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 2,
              "x": 0,
              "y": 0
            },
            "id": 12,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "count(count by(cpu)(node_cpu{instance=~\"$server\"}))",
                "intervalFactor": 2,
                "refId": "A",
                "step": 60
              }
            ],
            "thresholds": "",
            "title": "Cores",
            "type": "singlestat",
            "valueFontSize": "80%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "avg"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(245, 54, 54, 0.9)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(50, 172, 45, 0.97)"
            ],
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "format": "bytes",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 2,
              "y": 0
            },
            "id": 14,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "sum(node_filesystem_size{instance=~\"$server\", device=~\"/dev/.*\"})",
                "intervalFactor": 1,
                "refId": "A",
                "step": 30
              }
            ],
            "thresholds": "",
            "title": "Disk Total",
            "type": "singlestat",
            "valueFontSize": "80%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "avg"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(245, 54, 54, 0.9)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(50, 172, 45, 0.97)"
            ],
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "format": "bytes",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 6,
              "y": 0
            },
            "id": 13,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "node_memory_MemTotal{instance=~\"$server\"}",
                "intervalFactor": 1,
                "refId": "A",
                "step": 30
              }
            ],
            "thresholds": "",
            "title": "Total Memory",
            "type": "singlestat",
            "valueFontSize": "80%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "avg"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": true,
            "colors": [
              "rgba(50, 172, 45, 0.97)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(245, 54, 54, 0.9)"
            ],
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "format": "short",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 10,
              "y": 0
            },
            "id": 11,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": true
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "node_load1{instance=~\"$server\"}",
                "intervalFactor": 2,
                "legendFormat": "",
                "metric": "",
                "refId": "A",
                "step": 60
              }
            ],
            "thresholds": "0.8,0.9",
            "title": "Load 1m",
            "type": "singlestat",
            "valueFontSize": "80%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "current"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(245, 54, 54, 0.9)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(50, 172, 45, 0.97)"
            ],
            "datasource": "prometheus",
            "decimals": 1,
            "editable": true,
            "error": false,
            "format": "s",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 6,
              "x": 14,
              "y": 0
            },
            "id": 15,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "time() - node_boot_time{instance=~\"$server\"}",
                "intervalFactor": 1,
                "refId": "A",
                "step": 30
              }
            ],
            "thresholds": "",
            "title": "Uptime",
            "type": "singlestat",
            "valueFontSize": "80%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "avg"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(245, 54, 54, 0.9)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(50, 172, 45, 0.97)"
            ],
            "datasource": "prometheus",
            "decimals": 2,
            "editable": true,
            "error": false,
            "format": "percentunit",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": false,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 20,
              "y": 0
            },
            "id": 17,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": true
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "sum(irate(node_exporter_scrape_duration_seconds_sum{instance=~\"$server\"}[5m]))",
                "intervalFactor": 2,
                "refId": "A",
                "step": 60
              }
            ],
            "thresholds": "",
            "title": "Scrape CPU use",
            "type": "singlestat",
            "valueFontSize": "80%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "avg"
          },
          {
            "alerting": {},
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 6,
              "w": 10,
              "x": 0,
              "y": 3
            },
            "id": 4,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [
              {
                "alias": "Free",
                "zindex": 3
              }
            ],
            "spaceLength": 10,
            "stack": true,
            "steppedLine": false,
            "targets": [
              {
                "expr": "node_memory_MemTotal{instance=~\"$server\"} - node_memory_MemFree{instance=~\"$server\"} - node_memory_Cached{instance=~\"$server\"} - node_memory_Buffers{instance=~\"$server\"} - node_memory_Slab{instance=~\"$server\"}",
                "intervalFactor": 2,
                "legendFormat": "Used",
                "metric": "memo",
                "refId": "A",
                "step": 10,
                "target": ""
              },
              {
                "expr": "node_memory_Buffers{instance=~\"$server\"}",
                "intervalFactor": 2,
                "legendFormat": "Buffers",
                "refId": "C",
                "step": 10
              },
              {
                "expr": "node_memory_Cached{instance=~\"$server\"} + node_memory_Slab{instance=~\"$server\"}",
                "intervalFactor": 2,
                "legendFormat": "Cached",
                "refId": "D",
                "step": 10
              },
              {
                "expr": "node_memory_MemFree{instance=~\"$server\"}",
                "hide": false,
                "intervalFactor": 2,
                "legendFormat": "Free",
                "refId": "B",
                "step": 10
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "Memory Usage",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "individual"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "bytes",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 6,
              "w": 6,
              "x": 10,
              "y": 3
            },
            "id": 18,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [
              {
                "alias": "Swap Out",
                "transform": "negative-Y"
              }
            ],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "node_vmstat_pswpin{instance=~\"$server\"}",
                "intervalFactor": 2,
                "legendFormat": "Swap In",
                "refId": "A",
                "step": 20
              },
              {
                "expr": "node_vmstat_pswpout{instance=~\"$server\"}",
                "intervalFactor": 2,
                "legendFormat": "Swap Out",
                "refId": "B",
                "step": 20
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "Swap Activity",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(245, 54, 54, 0.9)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(50, 172, 45, 0.97)"
            ],
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "format": "percent",
            "gauge": {
              "maxValue": 100,
              "minValue": 0,
              "show": true,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 6,
              "w": 4,
              "x": 16,
              "y": 3
            },
            "id": 5,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "( (node_memory_MemFree{instance=~\"$server\"} + node_memory_Cached{instance=~\"$server\"} + node_memory_Slab{instance=~\"$server\"} + node_memory_Buffers{instance=~\"$server\"} ) / node_memory_MemTotal{instance=~\"$server\"}) * 100",
                "intervalFactor": 2,
                "legendFormat": "",
                "refId": "A",
                "step": 60,
                "target": ""
              }
            ],
            "thresholds": "10, 20",
            "title": "Available memory",
            "type": "singlestat",
            "valueFontSize": "80%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "avg"
          },
          {
            "cacheTimeout": null,
            "colorBackground": false,
            "colorValue": false,
            "colors": [
              "rgba(245, 54, 54, 0.9)",
              "rgba(237, 129, 40, 0.89)",
              "rgba(50, 172, 45, 0.97)"
            ],
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "format": "percentunit",
            "gauge": {
              "maxValue": 1,
              "minValue": 0,
              "show": true,
              "thresholdLabels": false,
              "thresholdMarkers": true
            },
            "gridPos": {
              "h": 6,
              "w": 4,
              "x": 20,
              "y": 3
            },
            "id": 7,
            "interval": null,
            "links": [],
            "mappingType": 1,
            "mappingTypes": [
              {
                "name": "value to text",
                "value": 1
              },
              {
                "name": "range to text",
                "value": 2
              }
            ],
            "maxDataPoints": 100,
            "nullPointMode": "connected",
            "nullText": null,
            "postfix": "",
            "postfixFontSize": "50%",
            "prefix": "",
            "prefixFontSize": "50%",
            "rangeMaps": [
              {
                "from": "null",
                "text": "N/A",
                "to": "null"
              }
            ],
            "sparkline": {
              "fillColor": "rgba(31, 118, 189, 0.18)",
              "full": false,
              "lineColor": "rgb(31, 120, 193)",
              "show": false
            },
            "tableColumn": "",
            "targets": [
              {
                "expr": "min(node_filesystem_free{fstype=~\"xfs|ext4\",instance=~\"$server\"} / node_filesystem_size{fstype=~\"xfs|ext4\",instance=~\"$server\"})",
                "intervalFactor": 2,
                "legendFormat": "",
                "refId": "A",
                "step": 60,
                "target": ""
              }
            ],
            "thresholds": "0.10, 0.25",
            "title": "Free Filesystem (Lowest)",
            "type": "singlestat",
            "valueFontSize": "80%",
            "valueMaps": [
              {
                "op": "=",
                "text": "N/A",
                "value": "null"
              }
            ],
            "valueName": "current"
          },
          {
            "alerting": {},
            "aliasColors": {
              "AVG": "#DEDAF7"
            },
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 6,
              "w": 12,
              "x": 0,
              "y": 9
            },
            "id": 9,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "100 - (avg(irate(node_cpu{mode=\"idle\", instance=~\"$server\"}[5m])) * 100)",
                "hide": false,
                "interval": "",
                "intervalFactor": 4,
                "legendFormat": "AVG",
                "refId": "A",
                "step": 20
              },
              {
                "expr": "100 - (avg by (cpu) (irate(node_cpu{mode=\"idle\", instance=~\"$server\"}[5m])) * 100)",
                "hide": false,
                "intervalFactor": 10,
                "legendFormat": "{{cpu}}",
                "refId": "B",
                "step": 50
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "CPU Usage",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "percent",
                "label": "cpu usage",
                "logBase": 1,
                "max": 100,
                "min": 0,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "alerting": {},
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 6,
              "w": 12,
              "x": 12,
              "y": 9
            },
            "id": 23,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "node_load1{instance=~\"$server\"}",
                "intervalFactor": 4,
                "legendFormat": "load 1m",
                "refId": "A",
                "step": 20,
                "target": ""
              },
              {
                "expr": "node_load5{instance=~\"$server\"}",
                "intervalFactor": 4,
                "legendFormat": "load 5m",
                "refId": "B",
                "step": 20,
                "target": ""
              },
              {
                "expr": "node_load15{instance=~\"$server\"}",
                "intervalFactor": 4,
                "legendFormat": "load 15m",
                "refId": "C",
                "step": 20,
                "target": ""
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "System load",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "none",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 6,
              "w": 12,
              "x": 0,
              "y": 15
            },
            "id": 16,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [
              {
                "alias": "/.*outbound/",
                "transform": "negative-Y"
              }
            ],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "irate(node_network_transmit_bytes{instance=~\"$server\", device!~\"lo|bond[0-9]|cbr[0-9]|veth.*\"}[5m]) > 0",
                "intervalFactor": 2,
                "legendFormat": "{{device}} OUT",
                "refId": "A",
                "step": 10
              },
              {
                "expr": "irate(node_network_receive_bytes{instance=~\"$server\", device!~\"lo|bond[0-9]|cbr[0-9]|veth.*\"}[5m]) > 0",
                "intervalFactor": 2,
                "legendFormat": "{{device}} IN",
                "refId": "B",
                "step": 10
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "Network Usage",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "Bps",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": false
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "fill": 1,
            "gridPos": {
              "h": 6,
              "w": 12,
              "x": 12,
              "y": 15
            },
            "id": 25,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 1,
            "links": [],
            "nullPointMode": "null",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "node_tcp_connection_states{instance=~\"$server\"}",
                "intervalFactor": 2,
                "legendFormat": "{{state}}",
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "TCP Connections",
            "tooltip": {
              "shared": true,
              "sort": 0,
              "value_type": "individual"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "alerting": {},
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 10,
              "x": 0,
              "y": 21
            },
            "id": 6,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [
              {
                "alias": "read",
                "yaxis": 1
              },
              {
                "alias": "{instance=\"127.0.0.1:9100\"}",
                "yaxis": 2
              },
              {
                "alias": "io time",
                "yaxis": 2
              }
            ],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "sum by (instance) (irate(node_disk_reads_completed{instance=~\"$server\"}[5m]))",
                "hide": false,
                "intervalFactor": 4,
                "legendFormat": "reads per second",
                "refId": "A",
                "step": 20,
                "target": ""
              },
              {
                "expr": "sum by (instance) (irate(node_disk_writes_completed{instance=~\"$server\"}[5m]))",
                "intervalFactor": 4,
                "legendFormat": "writes per second",
                "refId": "B",
                "step": 20
              },
              {
                "expr": "sum by (instance) (irate(node_disk_io_time_ms{instance=~\"$server\"}[5m]))",
                "intervalFactor": 4,
                "legendFormat": "io time",
                "refId": "C",
                "step": 20
              },
              {
                "expr": "sum by (instance) (irate(node_disk_reads_completed{instance=~\"$server\"}[5m])) + sum by (instance) (irate(node_disk_writes_completed{instance=~\"$server\"}[5m]))",
                "intervalFactor": 2,
                "legendFormat": "IOPS",
                "refId": "D",
                "step": 10
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "IOPs",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "none",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "ms",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "alerting": {},
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 8,
              "x": 10,
              "y": 21
            },
            "id": 24,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [
              {
                "alias": "read",
                "yaxis": 1
              },
              {
                "alias": "{instance=\"172.17.0.1:9100\"}",
                "yaxis": 2
              },
              {
                "alias": "io time",
                "yaxis": 2
              }
            ],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "sum by (instance) (irate(node_disk_bytes_read{instance=~\"$server\"}[5m]))",
                "hide": false,
                "intervalFactor": 4,
                "legendFormat": "read",
                "refId": "A",
                "step": 20,
                "target": ""
              },
              {
                "expr": "sum by (instance) (irate(node_disk_bytes_written{instance=~\"$server\"}[5m]))",
                "intervalFactor": 4,
                "legendFormat": "written",
                "refId": "B",
                "step": 20
              },
              {
                "expr": "sum by (instance) (irate(node_disk_bytes_read{instance=~\"$server\"}[5m])) + sum by (instance) (irate(node_disk_bytes_written{instance=~\"$server\"}[5m]))",
                "interval": "",
                "intervalFactor": 4,
                "legendFormat": "total",
                "refId": "C",
                "step": 20
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "Disk usage",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 0,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "bytes",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "ms",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 1,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 6,
              "x": 18,
              "y": 21
            },
            "id": 22,
            "legend": {
              "alignAsTable": false,
              "avg": false,
              "current": false,
              "hideZero": true,
              "max": false,
              "min": false,
              "rightSide": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 1,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "rate(node_disk_io_time_ms{instance=~\"$server\"}[5m])",
                "intervalFactor": 2,
                "legendFormat": "{{device}}",
                "refId": "A",
                "step": 20
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "IO time by device",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 2,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "ms",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": false
              }
            ]
          },
          {
            "aliasColors": {},
            "bars": false,
            "dashLength": 10,
            "dashes": false,
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fill": 0,
            "grid": {},
            "gridPos": {
              "h": 7,
              "w": 12,
              "x": 0,
              "y": 28
            },
            "id": 19,
            "legend": {
              "avg": false,
              "current": false,
              "max": false,
              "min": false,
              "show": true,
              "total": false,
              "values": false
            },
            "lines": true,
            "linewidth": 2,
            "links": [],
            "nullPointMode": "connected",
            "percentage": false,
            "pointradius": 5,
            "points": false,
            "renderer": "flot",
            "seriesOverrides": [],
            "spaceLength": 10,
            "stack": false,
            "steppedLine": false,
            "targets": [
              {
                "expr": "topk(5, 100 - (node_filesystem_free{instance=~\"$server\",fstype=~\"xfs|ext4\"} / node_filesystem_size{instance=~\"$server\",fstype=~\"xfs|ext4\"} * 100))",
                "intervalFactor": 2,
                "legendFormat": "{{mountpoint}}",
                "refId": "A",
                "step": 10
              }
            ],
            "thresholds": [],
            "timeFrom": null,
            "timeShift": null,
            "title": "5 most used filesystems",
            "tooltip": {
              "msResolution": false,
              "shared": true,
              "sort": 2,
              "value_type": "cumulative"
            },
            "type": "graph",
            "xaxis": {
              "buckets": null,
              "mode": "time",
              "name": null,
              "show": true,
              "values": []
            },
            "yaxes": [
              {
                "format": "percent",
                "label": null,
                "logBase": 1,
                "max": 100,
                "min": 0,
                "show": true
              },
              {
                "format": "short",
                "label": null,
                "logBase": 1,
                "max": null,
                "min": null,
                "show": false
              }
            ]
          },
          {
            "columns": [
              {
                "text": "Current",
                "value": "current"
              }
            ],
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fontSize": "80%",
            "gridPos": {
              "h": 7,
              "w": 6,
              "x": 12,
              "y": 28
            },
            "id": 21,
            "links": [],
            "pageSize": null,
            "scroll": true,
            "showHeader": true,
            "sort": {
              "col": 1,
              "desc": true
            },
            "styles": [
              {
                "dateFormat": "YYYY-MM-DD HH:mm:ss",
                "pattern": "Time",
                "type": "date"
              },
              {
                "colorMode": null,
                "colors": [
                  "rgba(245, 54, 54, 0.9)",
                  "rgba(237, 129, 40, 0.89)",
                  "rgba(50, 172, 45, 0.97)"
                ],
                "decimals": 0,
                "pattern": "Current",
                "thresholds": [],
                "type": "number",
                "unit": "bytes"
              },
              {
                "colorMode": null,
                "colors": [
                  "rgba(245, 54, 54, 0.9)",
                  "rgba(237, 129, 40, 0.89)",
                  "rgba(50, 172, 45, 0.97)"
                ],
                "dateFormat": "YYYY-MM-DD HH:mm:ss",
                "decimals": 2,
                "pattern": "/.*/",
                "thresholds": [],
                "type": "number",
                "unit": "short"
              }
            ],
            "targets": [
              {
                "expr": "node_filesystem_size{instance=~\"$server\",fstype=~\"xfs|ext4\"}",
                "intervalFactor": 2,
                "legendFormat": "{{mountpoint}}",
                "refId": "A",
                "step": 20
              }
            ],
            "title": "Filesystem Size",
            "transform": "timeseries_aggregations",
            "type": "table"
          },
          {
            "columns": [
              {
                "text": "Current",
                "value": "current"
              },
              {
                "text": "Max",
                "value": "max"
              }
            ],
            "datasource": "prometheus",
            "editable": true,
            "error": false,
            "fontSize": "80%",
            "gridPos": {
              "h": 7,
              "w": 6,
              "x": 18,
              "y": 28
            },
            "id": 20,
            "links": [],
            "pageSize": null,
            "scroll": true,
            "showHeader": true,
            "sort": {
              "col": 1,
              "desc": true
            },
            "styles": [
              {
                "dateFormat": "YYYY-MM-DD HH:mm:ss",
                "pattern": "Time",
                "type": "date"
              },
              {
                "colorMode": null,
                "colors": [
                  "rgba(245, 54, 54, 0.9)",
                  "rgba(237, 129, 40, 0.89)",
                  "rgba(50, 172, 45, 0.97)"
                ],
                "decimals": 2,
                "pattern": "Current|Max",
                "thresholds": [],
                "type": "number",
                "unit": "percent"
              },
              {
                "colorMode": null,
                "colors": [
                  "rgba(245, 54, 54, 0.9)",
                  "rgba(237, 129, 40, 0.89)",
                  "rgba(50, 172, 45, 0.97)"
                ],
                "dateFormat": "YYYY-MM-DD HH:mm:ss",
                "decimals": 2,
                "pattern": "/.*/",
                "thresholds": [],
                "type": "number",
                "unit": "short"
              }
            ],
            "targets": [
              {
                "expr": "100 - (node_filesystem_free{instance=~\"$server\",fstype=~\"xfs|ext4\"} / node_filesystem_size{instance=~\"$server\",fstype=~\"xfs|ext4\"} * 100)",
                "intervalFactor": 2,
                "legendFormat": "{{mountpoint}}",
                "refId": "A",
                "step": 20
              }
            ],
            "title": "Use per Filesystem",
            "transform": "timeseries_aggregations",
            "type": "table"
          }
        ],
        "refresh": "5s",
        "schemaVersion": 16,
        "style": "dark",
        "tags": [
          "openshift",
          "nodes"
        ],
        "templating": {
          "list": [
            {
              "allValue": null,
              "current": {
                "text": "192.168.41.10:9100",
                "value": "192.168.41.10:9100"
              },
              "datasource": "prometheus",
              "hide": 0,
              "includeAll": false,
              "label": "Node",
              "multi": false,
              "name": "server",
              "options": [],
              "query": "label_values(node_boot_time, instance)",
              "refresh": 1,
              "regex": "",
              "sort": 0,
              "tagValuesQuery": "",
              "tags": [],
              "tagsQuery": "",
              "type": "query",
              "useTags": false
            }
          ]
        },
        "time": {
          "from": "now-3h",
          "to": "now"
        },
        "timepicker": {
          "refresh_intervals": [
            "5s",
            "10s",
            "30s",
            "1m",
            "5m",
            "15m",
            "30m",
            "1h",
            "2h",
            "1d"
          ],
          "time_options": [
            "5m",
            "15m",
            "1h",
            "6h",
            "12h",
            "24h",
            "2d",
            "7d",
            "30d"
          ]
        },
        "timezone": "browser",
        "title": "Cluster's Nodes Status",
        "uid": "_GNAhj3kk",
        "version": 1
      },
        "overwrite": false
      }
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: grafana-dsh-pod-resources
  data:
    pods-resources.json: |-
      {
      "dashboard": {
          "description": "Shows resource usage of OpenShift pods.",
          "editable": true,
          "links": [],
          "panels": [
            {
              "collapsed": false,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 0
              },
              "id": 35,
              "panels": [],
              "repeat": null,
              "title": "all pods",
              "type": "row"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": true,
              "colors": [
                "rgba(50, 172, 45, 0.97)",
                "rgba(237, 129, 40, 0.89)",
                "rgba(245, 54, 54, 0.9)"
              ],
              "datasource": "prometheus",
              "editable": true,
              "error": false,
              "format": "percent",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": true,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 5,
                "w": 8,
                "x": 0,
                "y": 1
              },
              "height": "180px",
              "id": 4,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "rgb(31, 120, 193)",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum (container_memory_working_set_bytes{id=\"/\",instance=~\"^$instance$\"}) / sum (machine_memory_bytes{instance=~\"^$instance$\"}) * 100",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "refId": "A",
                  "step": 2
                }
              ],
              "thresholds": "65, 90",
              "timeFrom": "1m",
              "timeShift": null,
              "title": "Memory Working Set",
              "transparent": false,
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": true,
              "colors": [
                "rgba(50, 172, 45, 0.97)",
                "rgba(237, 129, 40, 0.89)",
                "rgba(245, 54, 54, 0.9)"
              ],
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "format": "percent",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": true,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 5,
                "w": 8,
                "x": 8,
                "y": 1
              },
              "height": "180px",
              "id": 6,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "rgb(31, 120, 193)",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum(rate(container_cpu_usage_seconds_total{id=\"/\",instance=~\"^$instance$\"}[1m])) / sum (machine_cpu_cores{instance=~\"^$instance$\"}) * 100",
                  "interval": "10s",
                  "intervalFactor": 1,
                  "refId": "A",
                  "step": 10
                }
              ],
              "thresholds": "65, 90",
              "timeFrom": "1m",
              "timeShift": null,
              "title": "Cpu Usage",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": true,
              "colors": [
                "rgba(50, 172, 45, 0.97)",
                "rgba(237, 129, 40, 0.89)",
                "rgba(245, 54, 54, 0.9)"
              ],
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "format": "percent",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": true,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 5,
                "w": 8,
                "x": 16,
                "y": 1
              },
              "height": "180px",
              "id": 7,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "rgb(31, 120, 193)",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum(container_fs_usage_bytes{id=\"/\",instance=~\"^$instance$\"}) / sum(container_fs_limit_bytes{id=\"/\",instance=~\"^$instance$\"}) * 100",
                  "interval": "10s",
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "metric": "",
                  "refId": "A",
                  "step": 10
                }
              ],
              "thresholds": "65, 90",
              "timeFrom": "1m",
              "timeShift": null,
              "title": "Filesystem Usage",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "rgba(50, 172, 45, 0.97)",
                "rgba(237, 129, 40, 0.89)",
                "rgba(245, 54, 54, 0.9)"
              ],
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "format": "bytes",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 3,
                "w": 4,
                "x": 0,
                "y": 6
              },
              "height": "1px",
              "hideTimeOverride": true,
              "id": 9,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "20%",
              "prefix": "",
              "prefixFontSize": "20%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "rgb(31, 120, 193)",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum(container_memory_working_set_bytes{id=\"/\",instance=~\"^$instance$\"})",
                  "interval": "10s",
                  "intervalFactor": 1,
                  "refId": "A",
                  "step": 10
                }
              ],
              "thresholds": "",
              "timeFrom": "1m",
              "title": "Used",
              "type": "singlestat",
              "valueFontSize": "50%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "rgba(50, 172, 45, 0.97)",
                "rgba(237, 129, 40, 0.89)",
                "rgba(245, 54, 54, 0.9)"
              ],
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "format": "bytes",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 3,
                "w": 4,
                "x": 4,
                "y": 6
              },
              "height": "1px",
              "hideTimeOverride": true,
              "id": 10,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "rgb(31, 120, 193)",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum (machine_memory_bytes{instance=~\"^$instance$\"})",
                  "interval": "10s",
                  "intervalFactor": 1,
                  "refId": "A",
                  "step": 10
                }
              ],
              "thresholds": "",
              "timeFrom": "1m",
              "title": "Total",
              "type": "singlestat",
              "valueFontSize": "50%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "rgba(50, 172, 45, 0.97)",
                "rgba(237, 129, 40, 0.89)",
                "rgba(245, 54, 54, 0.9)"
              ],
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 3,
                "w": 4,
                "x": 8,
                "y": 6
              },
              "height": "1px",
              "hideTimeOverride": true,
              "id": 11,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": " cores",
              "postfixFontSize": "30%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "rgb(31, 120, 193)",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum (rate (container_cpu_usage_seconds_total{id=\"/\",instance=~\"^$instance$\"}[1m]))",
                  "interval": "10s",
                  "intervalFactor": 1,
                  "refId": "A",
                  "step": 10
                }
              ],
              "thresholds": "",
              "timeFrom": "1m",
              "timeShift": null,
              "title": "Used",
              "type": "singlestat",
              "valueFontSize": "50%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "rgba(50, 172, 45, 0.97)",
                "rgba(237, 129, 40, 0.89)",
                "rgba(245, 54, 54, 0.9)"
              ],
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 3,
                "w": 4,
                "x": 12,
                "y": 6
              },
              "height": "1px",
              "hideTimeOverride": true,
              "id": 12,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": " cores",
              "postfixFontSize": "30%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "rgb(31, 120, 193)",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum (machine_cpu_cores{instance=~\"^$instance$\"})",
                  "interval": "10s",
                  "intervalFactor": 1,
                  "refId": "A",
                  "step": 10
                }
              ],
              "thresholds": "",
              "timeFrom": "1m",
              "title": "Total",
              "type": "singlestat",
              "valueFontSize": "50%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "rgba(50, 172, 45, 0.97)",
                "rgba(237, 129, 40, 0.89)",
                "rgba(245, 54, 54, 0.9)"
              ],
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "format": "bytes",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 3,
                "w": 4,
                "x": 16,
                "y": 6
              },
              "height": "1px",
              "hideTimeOverride": true,
              "id": 13,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "rgb(31, 120, 193)",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum(container_fs_usage_bytes{id=\"/\",instance=~\"^$instance$\"})",
                  "interval": "10s",
                  "intervalFactor": 1,
                  "refId": "A",
                  "step": 10
                }
              ],
              "thresholds": "",
              "timeFrom": "1m",
              "title": "Used",
              "type": "singlestat",
              "valueFontSize": "50%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "rgba(50, 172, 45, 0.97)",
                "rgba(237, 129, 40, 0.89)",
                "rgba(245, 54, 54, 0.9)"
              ],
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "format": "bytes",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 3,
                "w": 4,
                "x": 20,
                "y": 6
              },
              "height": "1px",
              "hideTimeOverride": true,
              "id": 14,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "rgb(31, 120, 193)",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum (container_fs_limit_bytes{id=\"/\",instance=~\"^$instance$\"})",
                  "interval": "10s",
                  "intervalFactor": 1,
                  "refId": "A",
                  "step": 10
                }
              ],
              "thresholds": "",
              "timeFrom": "1m",
              "title": "Total",
              "type": "singlestat",
              "valueFontSize": "50%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "fill": 1,
              "grid": {},
              "gridPos": {
                "h": 5,
                "w": 24,
                "x": 0,
                "y": 9
              },
              "height": "200px",
              "id": 32,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": true,
                "sideWidth": 200,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 2,
              "links": [],
              "nullPointMode": "connected",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(container_network_receive_bytes_total{instance=~\"^$instance$\",namespace=~\"^$namespace$\"}[1m]))",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "receive",
                  "metric": "network",
                  "refId": "A",
                  "step": 4
                },
                {
                  "expr": "- sum(rate(container_network_transmit_bytes_total{instance=~\"^$instance$\",namespace=~\"^$namespace$\"}[1m]))",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "transmit",
                  "metric": "network",
                  "refId": "B",
                  "step": 4
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Network",
              "tooltip": {
                "msResolution": false,
                "shared": true,
                "sort": 0,
                "value_type": "cumulative"
              },
              "transparent": false,
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "Bps",
                  "label": "transmit / receive",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "Bps",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": false
                }
              ]
            },
            {
              "collapsed": false,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 14
              },
              "id": 36,
              "panels": [],
              "repeat": null,
              "title": "each pod",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "decimals": 3,
              "editable": true,
              "error": false,
              "fill": 0,
              "grid": {},
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 15
              },
              "height": "",
              "id": 17,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "hideEmpty": true,
                "hideZero": true,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 2,
              "links": [],
              "nullPointMode": "connected",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(container_cpu_usage_seconds_total{image!=\"\",name=~\"^k8s_.*\",instance=~\"^$instance$\",namespace=~\"^$namespace$\"}[1m])) by (pod_name)",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "{{ pod_name }}",
                  "metric": "container_cpu",
                  "refId": "A",
                  "step": 4
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Cpu Usage",
              "tooltip": {
                "msResolution": true,
                "shared": false,
                "sort": 2,
                "value_type": "cumulative"
              },
              "transparent": false,
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "none",
                  "label": "cores",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": false
                }
              ]
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "fill": 0,
              "grid": {},
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 22
              },
              "id": 33,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "hideEmpty": true,
                "hideZero": true,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 2,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum (container_memory_working_set_bytes{image!=\"\",name=~\"^k8s_.*\",instance=~\"^$instance$\",namespace=~\"^$namespace$\"}) by (pod_name)",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "{{ pod_name }}",
                  "metric": "",
                  "refId": "A",
                  "step": 4
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Memory Working Set",
              "tooltip": {
                "msResolution": false,
                "shared": false,
                "sort": 2,
                "value_type": "cumulative"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": "used",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": false
                }
              ]
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "fill": 1,
              "grid": {},
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 29
              },
              "id": 16,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "hideEmpty": true,
                "hideZero": true,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": true,
                "sideWidth": 200,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 2,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum (rate (container_network_receive_bytes_total{image!=\"\",name=~\"^k8s_.*\",instance=~\"^$instance$\",namespace=~\"^$namespace$\"}[1m])) by (pod_name)",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "{{ pod_name }} < in",
                  "metric": "network",
                  "refId": "A",
                  "step": 4
                },
                {
                  "expr": "- sum (rate (container_network_transmit_bytes_total{image!=\"\",name=~\"^k8s_.*\",instance=~\"^$instance$\",namespace=~\"^$namespace$\"}[1m])) by (pod_name)",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "{{ pod_name }} > out",
                  "metric": "network",
                  "refId": "B",
                  "step": 4
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Network",
              "tooltip": {
                "msResolution": false,
                "shared": false,
                "sort": 2,
                "value_type": "cumulative"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "Bps",
                  "label": "transmit / receive",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": false
                }
              ]
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus",
              "decimals": 2,
              "editable": true,
              "error": false,
              "fill": 1,
              "grid": {},
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 36
              },
              "id": 34,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "hideEmpty": true,
                "hideZero": true,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": true,
                "sideWidth": 200,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 2,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(container_fs_usage_bytes{image!=\"\",name=~\"^k8s_.*\",instance=~\"^$instance$\",namespace=~\"^$namespace$\"}) by (pod_name)",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "{{ pod_name }}",
                  "metric": "network",
                  "refId": "A",
                  "step": 4
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeShift": null,
              "title": "Filesystem",
              "tooltip": {
                "msResolution": false,
                "shared": false,
                "sort": 2,
                "value_type": "cumulative"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": "used",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": false
                }
              ]
            }
          ],
          "refresh": false,
          "schemaVersion": 16,
          "style": "dark",
          "tags": [
            "openshift",
            "pods",
            "containers"
          ],
          "templating": {
            "list": [
              {
                "allValue": ".*",
                "current": {
                  "text": "All",
                  "value": "$__all"
                },
                "datasource": "prometheus",
                "hide": 0,
                "includeAll": true,
                "label": "Instance",
                "multi": false,
                "name": "instance",
                "options": [],
                "query": "label_values(instance)",
                "refresh": 1,
                "regex": "",
                "sort": 0,
                "tagValuesQuery": "",
                "tags": [],
                "tagsQuery": "",
                "type": "query",
                "useTags": false
              },
              {
                "allValue": null,
                "current": {
                  "text": "All",
                  "value": "$__all"
                },
                "datasource": "prometheus",
                "hide": 0,
                "includeAll": true,
                "label": "Namespace",
                "multi": true,
                "name": "namespace",
                "options": [],
                "query": "label_values(namespace)",
                "refresh": 1,
                "regex": "",
                "sort": 0,
                "tagValuesQuery": "",
                "tags": [],
                "tagsQuery": "",
                "type": "query",
                "useTags": false
              }
            ]
          },
          "time": {
            "from": "now-3h",
            "to": "now"
          },
          "timepicker": {
            "refresh_intervals": [
              "5s",
              "10s",
              "30s",
              "1m",
              "5m",
              "15m",
              "30m",
              "1h",
              "2h",
              "1d"
            ],
            "time_options": [
              "5m",
              "15m",
              "1h",
              "6h",
              "12h",
              "24h",
              "2d",
              "7d",
              "30d"
            ]
          },
          "timezone": "browser",
          "title": "OpenShift Pods Resources",
          "uid": "uFT22jqzk",
          "version": 2
      },
        "overwrite": false
      }
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: import-script
  data:
    import.sh: |-
      #!/bin/bash
      /usr/bin/curl -X POST -H "Content-Type: application/json" -d @/var/tmp/prometheus-datasource/prometheus-datasource.json http://admin:${GRAFANA_PASSWORD}@grafana:3000/api/datasources
      /usr/bin/curl -X POST -H "Content-Type: application/json" -d @/var/tmp/HAProxy/HAProxy.json http://admin:${GRAFANA_PASSWORD}@grafana:3000/api/dashboards/db
      /usr/bin/curl -X POST -H "Content-Type: application/json" -d @/var/tmp/cluster-resources/cluster-resources.json http://admin:${GRAFANA_PASSWORD}@grafana:3000/api/dashboards/db
      /usr/bin/curl -X POST -H "Content-Type: application/json" -d @/var/tmp/go-metrics/go-metrics.json http://admin:${GRAFANA_PASSWORD}@grafana:3000/api/dashboards/db
      /usr/bin/curl -X POST -H "Content-Type: application/json" -d @/var/tmp/infra-overview/infra-overview.json http://admin:${GRAFANA_PASSWORD}@grafana:3000/api/dashboards/db
      /usr/bin/curl -X POST -H "Content-Type: application/json" -d @/var/tmp/node-status/node-status.json http://admin:${GRAFANA_PASSWORD}@grafana:3000/api/dashboards/db
      /usr/bin/curl -X POST -H "Content-Type: application/json" -d @/var/tmp/pods-resources/pods-resources.json http://admin:${GRAFANA_PASSWORD}@grafana:3000/api/dashboards/db
parameters:
- name: NAMESPACE
  displayName: Namespace name where Prometheus Stack will be deployed
  description: Namespace name where Prometheus Stack will be deployed
  value: 'monitoring'
  required: true
- name: APPLICATION_NAME
  displayName: Application name description to be used with labeling and Service Accounts
  description: Application name description to be used with labeling and Service Accounts
  value: 'prometheus'
- name: GRAFANA_DATA_VOL_SIZE
  displayName: Volume size for Grafana data
  description: Volume size for Grafana data
  value: 20Gi
- name: GRAFANA_APPLICATION_HOSTNAME
  displayName: 'Custom hostname for the service route.  Leave blank for default hostname, e.g.: <application-name>-<project>.<default-domain-suffix>'
  description: Custom hostname for the service route
- name: PROMETHEUS_APPLICATION_HOSTNAME
  displayName: 'Custom hostname for the service route.  Leave blank for default hostname, e.g.: <application-name>-<project>.<default-domain-suffix>'
  description: Custom hostname for the service route
- name: ALERTMANAGER_APPLICATION_HOSTNAME
  displayName: 'Custom hostname for the service route.  Leave blank for default hostname, e.g.: <application-name>-<project>.<default-domain-suffix>'
  description: Custom hostname for the service route
- name: HAPROXY_STATS_PASSWORD
  displayName: 'Password for the admin user on the internal HAProxy component for the router'
  description: 'Password for the admin user on the internal HAProxy component for the router'
  required: true
- name: USER
  displayName: 'OpenShift username who is deploying the Stack'
  description: 'OpenShift username who is deploying the Stack'
  value: 'john'
  required: true
- name: GRAFANA_PASSWORD
  displayName: 'Set password for Grafana admin user'
  description: 'Set password for Grafana admin user'
  value: 'secret'
  required: true
- name: RC_WEBHOOK
  displayName: 'RocketChat WebHook'
  description: 'RocketChat WebHook for AlertManager Integration'
  required: false